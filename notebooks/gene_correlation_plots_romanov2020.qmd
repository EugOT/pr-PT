{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "67176179",
   "metadata": {},
   "source": [
    "#### Gene Correlation Plots\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7efd4882",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b62f859a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8d868689",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d8c915a2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e4a4e4cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d6f99ab1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8464ed69",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41e579ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ee8abb5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "898244ef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b2271042",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ddb470aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c5dd41db",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b062c9e3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "55cec72a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c7fb7fdc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9b6ba75f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1d6fe83f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8799ff5b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b3c00150",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8298fcbf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c6927ac5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "152fcc6b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f2d67c49",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9846c8b7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bfbeb635",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15cbaa21",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8b1228b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "36d7f881",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cb8a96f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "37858878",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8fbc6fa3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4f19cdc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e3d00b25",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f74abe4f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5b7d0a52",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "66260796",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57ef88d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "09df2e37",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b7eb3cee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8b8c89e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "acd916af",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ad2c3149",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49aada23",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e99dcb2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "152a7b79",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e3b2ee0b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a18fa6df",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "43a001a1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "409f17d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "347d07da",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "10514bef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "540fca49",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "033b9846",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "12c35b48",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8d34fa79",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5603effb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00952552",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cf77763",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54b7c51b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d05dff98",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8af18e70",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "64102259",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d410775",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "de3cbc5e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e201b486",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "266839ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3ce262a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4c9882d6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f1b18983",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e45758bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75e16f9a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7700c252",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-E15\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f01886b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-E17\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "96219505",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P0\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cb686a33",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P2\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ab17a80",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P10\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d4f9e09",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P23\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "83f504b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8bab461f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9f04961",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "512995de",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a43541d0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "55ec0126",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d3164c0e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e9e3429",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be2c6435",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a52f4b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29c856cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f9557b66",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e45d95c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0f4b2e6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "debabccd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8c330b31",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df747e0d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "691bbb05",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cb65b331",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6a777493",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cae9f17e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0ab8e6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e7cfb69",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "05c9c142",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a864427",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7afe8741",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d05868c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4f8f1903",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a8383318",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "282324bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be46dca0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ab83d637",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ff7d9e35",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0d67385d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7063aacb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "77d8c8bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2ed5bf5d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3abbe518",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d3163958",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "953405e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b7ffef6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec2bbff0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00d3011e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3d71131f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b8c4dc56",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54cd135e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ef4e2c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2815bf07",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e51e000",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "60add325",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a317c4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "88738ced",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c5e59a38",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec40fb59",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1a97636d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "52f207c3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d44fb85e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "db44b873",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e8274a7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8b28dcba",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "32ea0f08",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3548a408",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "531ed63d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a0239beb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "05385aed",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4c6b2ea9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b069a322",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "655a2b93",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "03805008",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02320eef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e7aec05",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d786da16",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6da538fa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "734ad5d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af39857c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b21de2f9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "59dcae17",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9ddc58b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9966fb85",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61ad6dc7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71c4a4b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7903af76",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f1e5e937",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f4e413a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ef575e5c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95c9138b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "31f55078",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2a14c4f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c78d791c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "53f9b085",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75647aea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1adcb4e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29b880e3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "754e1f8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6674d5b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "73f8b564",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cdb89723",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "07970af8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e10d40f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "000219cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "66b383e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2c71fc0d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7c275f80",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e50dc596",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "84005f18",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "784ee5cd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a0c3ab08",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "04fb0e9f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "94a09b8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "147b5ef8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "380fa94b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5d90171a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d538a8b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc305dc4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a915b8ca",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cda4ecb8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be450bc5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a88d6f83",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fdb0930b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "939b3b43",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95ee826b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c68becfe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7ef19903",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5b444eb0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5b2d2a39",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "27ad5c1b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2dfff165",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "70179d5a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8af6d7f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1da72516",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "482c6852",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "490f97e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0065d273",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d6075262",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d54af062",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f20eb289",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41952561",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4b48a082",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aa3d44c1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f5f2763c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6ca44a80",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "86cdd0ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a88fce38",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50937068",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a7c64189",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b65db652",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b158fae",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c3039ae1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e7ce263d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "865c1720",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a8e4152c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "263b7276",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0fb7b87b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cbe5eba8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "270c26e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "feb9643f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4269d1d9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cacd94d3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bc674213",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a43451ab",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "369dc829",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ffafd3a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be8baf2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a76a91f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d4a89161",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8efdcf14",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b5343079",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec1c66ef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b48bc7c1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d5fc5e62",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1c78f79f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bb73e415",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ffa456a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3085ff96",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "253d883c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1afb1a01",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f1b57d3d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7f75fe69",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "38b4f5ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bc82f600",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fee1cf64",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "89d3956b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "65c62843",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9d2c7262",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc4387fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eef3a035",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7c1db3b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57eaa7b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "19c55810",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be8f0e3b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce3bcecb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7dc8233e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75b8a17d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6dcaf54f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2664f67d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8de5bed",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "66886a21",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ac65120d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fb2b578d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "adf62702",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6685e7e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a3d800a4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fc439337",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c07b6689",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9174c9e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b9cc3734",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b003958d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "592d4ba3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1a5fbabf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fccacc25",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4fbd244f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aeb37dea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "78bd3b10",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4dc3fe10",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7d3bf0be",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "73b44d6b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6a2fb3cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe6678ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cdc86a0a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2f9fca9e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "16322867",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fa36caf2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a0f7bfbb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71cbb29c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ceccc39f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "11515646",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7467e229",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "76965c20",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bde15efd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba2f1d3f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3ca2e1a1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6b92eb2b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02066899",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dddc3522",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e85cce5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61f00ceb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e86f9ddb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8eff106",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "633c9a38",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1ad108aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "38f03692",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a04ab25c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "21f9caf7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "998afc62",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f622480a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c2b42aac",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fa77c756",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bbb85edc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd9984e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8aba5fba",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e232c7e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e9b5b85",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6506f9d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "811c4851",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c582e286",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9e7036a7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "695bf50f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6f300770",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "afce4a25",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "478eaa4a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4bd0d473",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8a3ad2ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5fea2d09",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b5d001c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b95aa6ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8828aafb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ae1b8eb8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "05e2f0bc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2590dd57",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "de8e4868",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b9acee42",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00f4301c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a0b00308",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bd0e989b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3443a994",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8c0696e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "941ada42",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "70636f4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b053bfb6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3aa9a22c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ce3a8a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a2155360",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "000fb2aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d47014e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82ba76ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d83f17ec",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1aa3b972",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6c103a4f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dee0b089",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5e6b4f34",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc967a1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "673ebc28",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7389c417",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "693b6932",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3049556d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "995255d4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd395c78",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b18dbd4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f09b8b75",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c443da0e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6febc63a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "638ebeef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b9db0949",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b9ab6c05",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b9acb0cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "39d09c76",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f0a3471",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "19148798",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bc7d5bce",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5b31b95",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5e42fd39",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ee669399",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d6833fb0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4cf4e02b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bec27d6c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f0ffa140",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71b4f744",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d0c9cd20",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0efae702",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dcd500d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e512ff06",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6841e9e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd09404e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8a353677",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2c71ede8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "14900279",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95618c33",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e61a644",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e989cc7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50e24f83",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6dbfc5f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3ae26812",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "129b1bd8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9ececf97",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a1473207",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e26cced",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "48ca40b1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e7043267",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c7d644e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8c7abe1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f4d7388a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4cb38d74",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2bafbe6f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c3533a1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "99f65280",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be0d4c81",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ab572784",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be272767",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b5b0306",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "67825973",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "01ccd0c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54ce71f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "524a5ec4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "494692e6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cbc422be",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1efd363e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "62dcdc4a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ff5094d0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "22bd47aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57278ecb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d96391fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "453302d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "557115b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1fd5ae99",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8263936c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "64234fb3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "25d1166e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b769bfeb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7741dd1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15732351",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "889177e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cee3ef02",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1445646d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02f28fa5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d3af2c89",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f063616b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3dcb5966",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "48c7e530",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e6347b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fafa373b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be970906",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9f4b590b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0478e3ae",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0235d854",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aca5331d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E15\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1380c232",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"E17\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e46be5e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P0\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "40bcd94e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P2\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc5fe2ca",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P10\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "30bf7653",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  nature2020 |> subset(Age == \"P23\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  }
 ],
 "metadata": {},
 "nbformat": 4,
 "nbformat_minor": 5
}
