{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "b5ef8a4e",
   "metadata": {},
   "source": [
    "#### Gene Correlation Plots\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00df21a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c813294d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "32d218d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "59518bd0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "69dee20d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "beb4c4f3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b40818ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "169601e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "883cc222",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e923779f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "91030c28",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c3f8dd11",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5142abba",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d8919a40",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cfbc7e22",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d5f57834",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a6dcb61",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6f651da5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3121a142",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5377effd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8976bd89",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "16039273",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "016732dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4be8aca2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "277dcbf9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9c5380a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "938c0022",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "124c64c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc1d3ef4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c47d02b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fbd81ec7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1642b00e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd6604fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "28ad3a85",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0bdcd455",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f86ee4d9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6099a3e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fdd20359",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "127ff0ba",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "33effc06",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a9139cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "76b87cd5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b6beba54",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6896b878",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ea052e4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e5a9345",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb03a0e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54ed928b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f093ddd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6240a32d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ea6948e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d35cea82",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29e21b8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "47357efa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b0422b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba7226c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a2c89e04",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82aa9873",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4237c2b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f81c045c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0a97983d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "feac8018",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b5ae176e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9b141aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0905d19f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fec328b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cea3cd89",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35a5be0b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fdede935",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f6fbef7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "afba080d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0b30845",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9dfaf97d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-E15\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "70a47a90",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-E17\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9926656e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P0\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc5460f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P2\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e0c829c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P10\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e3cf6d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P23\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "67a7cd13",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e4cbc43",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bd427865",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35bd4b82",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e1365af7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "47c1d5e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b1586377",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d6acdd31",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7ea81e82",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e9e9490b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bbfca26b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95717380",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e37026d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c012f611",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8111b721",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "462f7af3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6dc58290",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "884f8180",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "498d0e96",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00c1421d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e01d7c54",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f67b5181",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3f362b77",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6e19621",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df507d84",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e5309e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d1102d76",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4de9ff97",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9660b703",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fc28f98d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a90f847b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2fdcff74",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6312d8e6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fece72b7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "109c4c52",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15a4c74d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7f9f1983",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a4b547a8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e57b56f0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f8491c73",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82a923c1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "597db76d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9bc02e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e45f8f6c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0fbd637d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed2e2f46",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bcaa666b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e507f1d6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7bdf8160",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "53f63cd1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4aca3fa2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2ef39cb2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "843f392a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "96ea6c10",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2ec779f3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "34e01c42",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "63d841fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8b5a601",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7b9ed5f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49b72291",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9bf900ed",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "11d58eb8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8f3c398",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "455fbe4d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "16f65734",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "211dd2cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e5f6b85",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b2ce667",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b3f8306a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "21d77808",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cda72f14",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b30325a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00e4228d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e04cf82",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4d583a3b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bece816c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "62d150e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "60425ef2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5b66a19c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d9207b99",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1868d335",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8117ada9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1fbffbd5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7121d896",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "949c8e75",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b5d8c310",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "88a0d93d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8a593b11",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9a29b4f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe328b78",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6551f506",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c51180fd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6c1132d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e1f05ee7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "94d60c56",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f2c1c91e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "74c1a3fc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a82ea135",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0829afe4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "31b4db3b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8aaab6d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d3b2c0a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "88c7c9a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce6ae018",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57122609",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9c8368ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5be2e03d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e593c30",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7d11b5f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e97c955",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "73a8b7ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0be2c8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0c60dd8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "946efe11",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b9b441dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d9fb0935",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "321cab4a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b722a695",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4785101d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "daef5329",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "64cacebc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6597fcec",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f4eb1216",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b648d623",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "445af68c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b499aafe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "22e62dbe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1dd249e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b544c26",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "60a5b920",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3320a890",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "585c9ddf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ceb6996d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "62d13f28",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "990300ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "de8838c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8fd45972",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aa54b436",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c7dbc0b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dee8ba67",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9e633892",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "20999572",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bfaca8a1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4374dc7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "db92a65b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "368d416b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce3942d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "299ae630",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6dbd3793",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "60656989",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a356a1fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e132dc2c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "72a7b7cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "27b03f62",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b955a968",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb70ac6d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c65d104b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2780fb75",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f91a3c6e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c5c374e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9ae51249",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a79fc63a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "138ce894",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6aca8e23",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1034c036",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "74afbb38",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "69b2196d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "543f9bfe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a79ec68",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc804316",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0dee8dd5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bddd91f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f12d92be",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7d1866f9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4fb83390",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a3bd40d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c7d4cdec",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c416567b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bbb152af",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1a2d9926",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c0796be8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f26ba26b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3c21d40e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0b2089b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "845ddd3a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "180117b5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6b2d6dc8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4ca0ee7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bf4d7640",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bc2d4c68",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "410dd34f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "12f14805",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d9b1a9f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fdff2e70",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4dc154f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a267ac8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57cc7e02",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cf967fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d592d482",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a34f44fe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "18a6350f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1c47a5b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "24bcc578",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4fb33951",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "86c8e3aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "20063d2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4877447a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6795505",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "18e2eb8e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2aa74af3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9b030a00",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f5d6eae7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "10027155",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f5410e04",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c455191c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "208869f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b69796d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "294b38f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "097d2b01",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e51d7d41",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b56c2b4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0e95db7d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0be02810",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a405aef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "948cacd3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "81e5b365",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "449f3bbe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "997ff506",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54bb2abd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ef84381a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fab66a32",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8f786790",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f3c78e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "296344f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ea6cf2a8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d038d9e6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "25032c85",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3fae899a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b83026a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "04bb4ae5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c6c0d194",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c78889ae",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b9ba2aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2f49fa26",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "671c3b96",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "040fea02",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f4e9475c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dd947413",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "68f4f697",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3daaa39d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5c613a24",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ca704405",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e48f83c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c287153f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8bec8a15",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50baf394",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b8e7631",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "611aaca4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1711cb60",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a72b2606",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "048379f0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4a5c91e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3084e7b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "20d95859",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "953141f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0bdcfffd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2a2893f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "881ee12c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "454ea85f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a5ffb5e7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e307892d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9f21abc7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61887424",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c0147467",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "51a6b3b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45f004ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc7e35c3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b1f04ce7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5deb1f06",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a357701c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dee884db",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe5e4c8b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41cc1d2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5ed61c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec14832d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "409c2de4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "221d3f56",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e325ee36",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "812b4ba7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bf85a10d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e999dee1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "339b283a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a6c267af",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82c81cc8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe7fa593",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d5bab388",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f9def625",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c47ce3ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3d07bcfc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1ac79ef9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "089392dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75057764",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba23cbee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "52bfd229",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2fea7f8a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e860135a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6d0ec728",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b1097acf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "de71ad6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d90d5e9a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8b2d2016",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "704cea45",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ef06e89e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7103174e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af9988f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "033c1c6e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "39df40c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0869f3e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1fd54d56",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7342b70c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5ddf1617",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dd5e6310",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9a7bb6d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cdba4d73",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "212c7e0a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "59b72b92",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "18518ffd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "593d2250",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "440bd2ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b33b6fa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "564e82c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d582d6c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "06ea7a0f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02294311",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b1010d97",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d3d93a7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e65f8de",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b217ac33",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6e7e08bd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d1e1891a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "91ce322d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "91ac8167",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f3a6b91",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0b14a63",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b407c47d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f302664",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f70e42ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "64acf753",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a6527446",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5e822f7a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc75fdb3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "87e40731",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "222d9c5f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4902660",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dbec26cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bce437c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce2c01cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71660530",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5834c690",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ffd3436f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58bb9f74",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd3823b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "03068744",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "51c1d313",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c1e9cced",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "334f7df7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71900964",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5df4333b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d21e6d9f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5533d844",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61e5b69b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f3cf07b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a2d0dd2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f9227685",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c987bcfd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9ea8b47e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7cdc0e4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c849b8a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5b1bb4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e851cb3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c45980b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b4696720",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eba0f95e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8f56a99",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "428948ac",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "88a4f63a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a435169",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f69832c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8c988f20",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1fd7874d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  }
 ],
 "metadata": {},
 "nbformat": 4,
 "nbformat_minor": 5
}
