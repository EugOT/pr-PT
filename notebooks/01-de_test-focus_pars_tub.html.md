---
title: "Differential expression analysis of Hypothalamus datasets from Kim DW et al., 2020 and Romanov et al., 2020 with focus on Pars Tuberalis"
author: "Evgenii O. Tretiakov"
date: "2025-01-14"
format:
  elsevier-html:
    toc: true
    df-print: paged
    code-fold: true
    fig-width: 9
    fig-height: 12
    fig-format: retina
    fig-responsive: true
    fig-dpi: 120
  elsevier-pdf:
    colorlinks: true
    fontsize: 12pt
execute:
  keep-md: true
  echo: true
  error: false
  message: false
  warning: false
  debug: false
knitr:
  opts_chunk:
    autodep: true
---


::: {.cell .hidden}

```{.r .cell-code .hidden}
#| label: setup
#| include: false
DOCNAME <- "pars-tuberalis-analysis"
NOW <- Sys.time()

# Time chunks during knitting
knitr::knit_hooks$set(timeit = function(before) {
  if (before) {
    print(paste("Start:", Sys.time()))
    NOW <<- Sys.time()
  } else {
    print(paste("Stop:", Sys.time()))
    print(Sys.time() - NOW)
  }
})

knitr::knit_hooks$set(debug = function(before, options, envir) {
  if (!before) {
    message(
      paste(names(envir), as.list(envir),
        sep = " = ", collapse = "\n"
      )
    )
  }
})

knitr::opts_chunk$set(
  cache          = FALSE,
  dev            = c("png", "pdf"),
  timeit         = TRUE
)
```
:::





## Load data and setup parameters





::: {.cell}

```{.r .cell-code .hidden}
#| label: libraries
#| cache: false
# Load tidyverse infrastructure packages
suppressPackageStartupMessages({
  library(future)
  library(here)
  library(tidyverse)
  library(magrittr)
  library(stringr)
  library(skimr)
  library(RColorBrewer)
  library(viridis)
})


# Load packages for scRNA-seq analysis and visualisation
suppressPackageStartupMessages({
  library(ggplot2)
  library(cowplot)
  library(patchwork)
  library(ggstatsplot)
  library(Seurat)
  library(SeuratWrappers)
  library(scCustomize)
})
```
:::





### Set paths





::: {.cell}

```{.r .cell-code .hidden}
#| label: paths
src_dir <- here("code")
data_dir <- here("data")
output_dir <- here("output")
plots_dir <- here(output_dir, "figures/")
tables_dir <- here(output_dir, "tables/")
```
:::





### Load helper functions and gene-sets





::: {.cell}

```{.r .cell-code .hidden}
#| label: source
#| cache: false
source(here(src_dir, "genes.R"))
source(here(src_dir, "functions.R"))
```
:::





### Set fixed variables





::: {.cell}

```{.r .cell-code .hidden}
#| label: params-computation
#| cache: false
# set seed
reseed <- 42
set.seed(seed = reseed)

# Parameters for parallel execution
n_cores <- parallelly::availableCores() / 2 - 1
plan("multisession", workers = n_cores)
options(
  future.globals.maxSize = 100000 * 1024^2,
  future.rng.onMisuse = "ignore"
)
plan()
```

::: {.cell-output .cell-output-stdout}

```
multisession:
- args: function (..., workers = c(cgroups2.cpu.max = 6), envir = parent.frame())
- tweaked: TRUE
- call: plan("multisession", workers = n_cores)
```


:::

```{.r .cell-code .hidden}
#| label: params-computation
#| cache: false
# ggplot2 theme
theme_set(theme_minimal(base_size = 12))
```
:::

::: {.cell}

```{.r .cell-code .hidden}
#| label: params
bioproject <- "PRJNA547712"
project <- "kim2020_Hypoth-dev"
cb_fpr <- 0.001
low_cutoff_gene <- 500
high_cutoff_gene <- NULL
high_cutoff_gene <- 5000
low_cutoff_umis <- NULL
low_cutoff_umis <- -Inf
high_cutoff_umis <- 25000
high_cutoff_pc_mt <- 15
high_cutoff_pc_ribo <- 20
high_cutoff_pc_hb <- 0.1
high_cutoff_doublet_score <- 0.33
high_cutoff_complexity <- 0.85
connectivity_model <- "min_tree"
k <- 10
metric <- "euclidean"
signature <- 100
```
:::





## Load data from Kim DW et al 2020 (bioproject PRJNA547712)





::: {.cell}

```{.r .cell-code .hidden}
#| label: convert-to-seurat
srt.kim <- schard::h5ad2seurat(here(
  data_dir,
  "kim2020_combined.h5ad"
), use.raw = TRUE)

X_umap <- srt.kim@meta.data |>
  select(X, Y, Z) |>
  as.matrix()
colnames(X_umap) <- c("UMAP_1", "UMAP_2", "UMAP_3")
rownames(X_umap) <- colnames(srt.kim)
srt.kim[["umap"]] <- CreateDimReducObject(embeddings = X_umap, key = "umap_", assay = DefaultAssay(srt.kim))
srt.kim$Age %<>% forcats::fct(levels = c(
  "E10", "E11", "E12", "E13", "E14",
  "E15", "E16", "E17", "E18", "P0",
  "P2", "P4", "P8", "P10", "P14", "P23", "P45"
))

Idents(srt.kim) <- "Age"
srt.kim <- Store_Palette_Seurat(seurat_object = srt.kim, palette = rev(brewer.pal(n = 11, name = "Spectral")), palette_name = "expr_Colour_Pal")
```

::: {.cell-output .cell-output-stderr .hidden}

```
Seurat Object now contains the following items in @misc slot:
ℹ 'expr_Colour_Pal'
```


:::
:::

::: {.cell}

```{.r .cell-code .hidden}
#| label: load-seurat
print(srt.kim)
```

::: {.cell-output .cell-output-stdout}

```
An object of class Seurat 
27998 features across 128006 samples within 1 assay 
Active assay: RNA (27998 features, 0 variable features)
 2 layers present: counts, data
 1 dimensional reduction calculated: umap
```


:::

```{.r .cell-code .hidden}
#| label: load-seurat
srt.romanov.pub <- readRDS("/data/1_heteroAstrocytes/PRJNA548917/old/oldCCA_nae_srt.rds") # Load the Seurat object deposited to GEO by Romanov et al. (2020)
srt.romanov.pub <- UpdateSeuratObject(srt.romanov.pub)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Validating object structure
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Updating object slots
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Ensuring keys are in the proper structure
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Updating matrix keys for DimReduc 'pca'
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Updating matrix keys for DimReduc 'tsne'
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Updating matrix keys for DimReduc 'umap'
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: Assay RNA changing from Assay to Assay
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: DimReduc pca changing from DimReduc to DimReduc
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: DimReduc tsne changing from DimReduc to DimReduc
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: DimReduc umap changing from DimReduc to DimReduc
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Ensuring keys are in the proper structure
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Ensuring feature names don't have underscores or pipes
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Updating slots in RNA
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Updating slots in pca
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Updating slots in tsne
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Setting tsne DimReduc to global
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Updating slots in umap
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Setting umap DimReduc to global
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Validating object structure for Assay 'RNA'
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Validating object structure for DimReduc 'pca'
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Validating object structure for DimReduc 'tsne'
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Validating object structure for DimReduc 'umap'
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Object representation is consistent with the most current Seurat version
```


:::

```{.r .cell-code .hidden}
#| label: load-seurat
srt.romanov.pub$Age <-
  Cells(srt.romanov.pub) |>
  str_split(pattern = ":", simplify = T) %>%
  .[, 1] %>%
  str_split_fixed(pattern = "_", n = 3) %>%
  .[, 3]
srt.romanov.pub$Age %<>% forcats::fct(levels = c(
  "E10", "E11", "E12", "E13", "E14",
  "E15", "E16", "E17", "E18", "P0",
  "P2", "3P2", "P4", "P8", "1P10",
  "P10", "P14", "P23", "P45"
))
srt.romanov.pub$Age %<>% fct_collapse(
  P2 = c("P2", "3P2"),
  P10 = c("1P10", "P10")
)
srt.romanov.pub <- Store_Palette_Seurat(
  seurat_object = srt.romanov.pub,
  palette = read_lines(here(data_dir, "colours_wtree.tsv")), palette_name = "wtree_Colour_Pal"
)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Seurat Object now contains the following items in @misc slot:
ℹ 'vst.out' and 'wtree_Colour_Pal'
```


:::

```{.r .cell-code .hidden}
#| label: load-seurat
names(srt.romanov.pub@misc$wtree_Colour_Pal) <- 1:45
print(srt.romanov.pub)
```

::: {.cell-output .cell-output-stdout}

```
An object of class Seurat 
24340 features across 51199 samples within 1 assay 
Active assay: RNA (24340 features, 3500 variable features)
 3 layers present: counts, data, scale.data
 3 dimensional reductions calculated: pca, tsne, umap
```


:::

```{.r .cell-code .hidden}
#| label: load-seurat
glimpse(srt.romanov.pub@meta.data)
```

::: {.cell-output .cell-output-stdout}

```
Rows: 51,199
Columns: 20
$ nGene            <int> 1652, 782, 447, 1706, 1106, 894, 727, 734, 669, 617, …
$ nUMI             <dbl> 2787, 1090, 544, 2709, 1817, 1220, 995, 1036, 920, 86…
$ orig.ident       <fct> Hypothalamus, Hypothalamus, Hypothalamus, Hypothalamu…
$ res.0.2          <chr> "23", "23", "23", "23", "23", "23", "23", "23", "23",…
$ res.0.4          <chr> "34", "34", "34", "34", "34", "34", "34", "34", "34",…
$ res.0.8          <chr> "42", "42", "42", "42", "42", "42", "42", "42", "42",…
$ res.1.2          <chr> "47", "47", "47", "47", "47", "47", "47", "47", "47",…
$ res.2            <chr> "54", "54", "54", "54", "54", "54", "54", "54", "54",…
$ tree.ident       <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ pro_Inter        <chr> "41", "41", "41", "41", "41", "41", "41", "41", "41",…
$ pro_Enter        <chr> "41", "41", "41", "41", "41", "41", "41", "41", "41",…
$ tree_final       <fct> 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 1…
$ subtree          <fct> 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 4…
$ prim_walktrap    <fct> 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 3…
$ umi_per_gene     <dbl> 1.687046, 1.393862, 1.217002, 1.587925, 1.642857, 1.3…
$ log_umi_per_gene <dbl> 0.22712693, 0.14421974, 0.08529138, 0.20082998, 0.215…
$ nCount_RNA       <dbl> 2787, 1090, 544, 2709, 1817, 1220, 995, 1036, 920, 86…
$ nFeature_RNA     <int> 1652, 782, 447, 1706, 1106, 894, 727, 734, 669, 617, …
$ wtree            <fct> 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 3…
$ Age              <fct> P23, P2, P2, P2, P2, P2, P2, P2, P2, P2, P2, P2, P2, …
```


:::

```{.r .cell-code .hidden}
#| label: load-seurat
table(Idents(srt.romanov.pub))
```

::: {.cell-output .cell-output-stdout}

```

    1     2     3     4     5     6     7     8     9    10    11    12    13 
 2344  8146   395   402  3234   712   552   374   259   952 13727  1615   765 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
  832  1244   792   590   808  2486  1683   628  1039  1750   292   394   547 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
  391   407   507    93    81   402   143   701   222   353   324    73    78 
   40    41    42    43    44    45 
  328   190    73    37   179    55 
```


:::

```{.r .cell-code .hidden}
#| label: load-seurat
srt.romanov.pt <- subset(srt.romanov.pub, idents = c("38", "42", "45"))
print(srt.romanov.pt)
```

::: {.cell-output .cell-output-stdout}

```
An object of class Seurat 
24340 features across 201 samples within 1 assay 
Active assay: RNA (24340 features, 3500 variable features)
 3 layers present: counts, data, scale.data
 3 dimensional reductions calculated: pca, tsne, umap
```


:::
:::

::: {#cell-fig-feature-romanov2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-feature-romanov2020
#| fig-cap: "Feature plot of selected genes in hypothalamus across different developmental stages in the Romanov et al. (2020) dataset (original UMAP embedding). Cells are colored by expression level.  Note the distinct localization patterns of each gene."
#| fig-width: 24
#| fig-height: 36
#| fig-dpi: 90
FeaturePlot(
  srt.romanov.pub,
  features = c(
    "Tshb", "Cck", "Pitx1",
    "Eya1", "Eya2", "Eya3", "Eya4",
    "Sox2", "Hlf", "Tshr",
    "Cckar", "Cckbr", "Gpr173",
    "Foxl2", "Lhx3", "Lhx4", "Pit1", "Gata2"
  ),
  label = F,
  blend = F,
  order = TRUE,
  pt.size = 1.2,
  raster.dpi = c(512, 512),
  alpha = 0.5,
  split.by = "Age"
)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: The following requested variables were not found: Pit1
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
All cells have the same value (0) of "Foxl2"
All cells have the same value (0) of "Foxl2"
All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output-display}
![Feature plot of selected genes in hypothalamus across different developmental stages in the Romanov et al. (2020) dataset (original UMAP embedding). Cells are colored by expression level.  Note the distinct localization patterns of each gene.](01-de_test-focus_pars_tub_files/figure-html/fig-feature-romanov2020-1.png){#fig-feature-romanov2020 width=2160}
:::
:::

::: {#cell-fig-feature-pt-romanov2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-feature-pt-romanov2020
#| fig.cap: "Feature plot of selected genes in hypothalamus across different developmental stages in the subset of the pars tuberalis clusters from the Romanov et al. (2020) dataset (original UMAP embedding). Cells are colored by a gene expression level.  Note the distinct localization patterns of each gene."
#| fig-width: 24
#| fig-height: 36
FeaturePlot(
  srt.romanov.pt,
  features = c(
    "Tshb", "Cck", "Pitx1",
    "Eya1", "Eya2", "Eya3", "Eya4",
    "Sox2", "Hlf", "Tshr",
    "Cckar", "Cckbr", "Gpr173",
    "Foxl2", "Lhx3", "Lhx4", "Pit1", "Gata2"
  ),
  label = T,
  blend = F,
  order = TRUE,
  pt.size = 1.2,
  raster.dpi = c(512, 512),
  alpha = 0.5,
  split.by = "Age"
)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: The following requested variables were not found: Pit1
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Tshb"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cck"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Pitx1"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Eya1"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Eya3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Hlf"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Tshr"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckar"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckbr"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Gpr173"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx4"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Gata2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Tshb"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cck"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Pitx1"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Eya1"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Eya2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Eya3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Eya4"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Sox2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Tshr"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckar"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckbr"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Gpr173"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx4"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Gata2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckar"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckbr"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Eya2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Eya3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx4"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckar"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckbr"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx4"
```


:::

::: {.cell-output-display}
![Feature plot of selected genes in hypothalamus across different developmental stages in the subset of the pars tuberalis clusters from the Romanov et al. (2020) dataset (original UMAP embedding). Cells are colored by a gene expression level.  Note the distinct localization patterns of each gene.](01-de_test-focus_pars_tub_files/figure-html/fig-feature-pt-romanov2020-1.png){#fig-feature-pt-romanov2020 width=2304}
:::
:::

::: {.cell}

```{.r .cell-code .hidden}
#| label: norm-scale-matrix
# Using gene name patterns
srt.kim <- Add_Mito_Ribo(object = srt.kim, species = "Mouse", ensembl_ids = FALSE)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Adding Percent Mitochondrial genes for Mouse using gene symbol pattern: "^mt-".
Adding Percent Ribosomal genes for Mouse using gene symbol pattern: "^Rp[sl]".
Adding Percent Mito+Ribo by adding Mito & Ribo percentages.
```


:::

```{.r .cell-code .hidden}
#| label: norm-scale-matrix
srt.kim$umi_per_gene <- 
  (srt.kim$nCount_RNA/srt.kim$nFeature_RNA)
srt.kim$log_umi_per_gene <- 
  log10(srt.kim$umi_per_gene)
srt.kim <- NormalizeData(srt.kim)
srt.kim <- FindVariableFeatures(srt.kim, selection.method = "vst", nfeatures = 5000)
all.genes <- rownames(srt.kim)
srt.kim <- ScaleData(srt.kim, features = all.genes, vars.to.regress = c("log_umi_per_gene", "percent_mito_ribo"))
```

::: {.cell-output .cell-output-stderr .hidden}

```
Regressing out log_umi_per_gene, percent_mito_ribo
Centering and scaling data matrix
```


:::

```{.r .cell-code .hidden}
#| label: norm-scale-matrix
# srt.kim <- ScaleData(srt.kim)
```
:::

::: {.cell}

```{.r .cell-code .hidden}
#| label: transfer-annotations
hypoth.anchors <- FindTransferAnchors(
  reference = srt.romanov.pub,
  query = srt.kim,
  dims = 1:30,
  npcs = 30,
  reference.reduction = "pca",
  reduction = "rpca",
  k.anchor = 15,
  k.filter = 30,
  k.score = 50,
  max.features = 500,
  nn.method = "annoy",
  n.trees = 200
)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Performing PCA on the provided query using 3500 features as input.
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Centering and scaling data matrix
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Projecting new data onto SVD
Projecting new data onto SVD
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Projecting cell embeddings
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Finding neighborhoods
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Finding anchors
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
	Found 6393 anchors
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Filtering anchors
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
	Retained 397 anchors
```


:::

```{.r .cell-code .hidden}
#| label: transfer-annotations
predictions <- TransferData(anchorset = hypoth.anchors, refdata = srt.romanov.pub$wtree, dims = 1:30) # TODO: check if I can randomly subset the reference data to handle the imbalance of clusters
```

::: {.cell-output .cell-output-stderr .hidden}

```
Finding integration vectors
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Finding integration vector weights
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Predicting cell labels
```


:::

```{.r .cell-code .hidden}
#| label: transfer-annotations
srt.kim <- AddMetaData(srt.kim, metadata = predictions)
table(srt.kim$predicted.id)
```

::: {.cell-output .cell-output-stdout}

```

    1    12    13    15    19     2    20    21    22    23    26    27    29 
 1504  2751  7692  5423 76464  1508  2952  6239   264   141    20  3053  1733 
    3    32    38     4    44    45     5     6     7     8 
 1580     3   264   124    38 10653  1897  3291   161   251 
```


:::
:::

::: {.cell}

```{.r .cell-code .hidden}
#| label: transfer-umap
srt.romanov.pub <- RunUMAP(srt.romanov.pub, dims = 1:30, reduction = "pca", return.model = TRUE)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'
This message will be shown once per session
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
UMAP will return its model
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
12:35:28 UMAP embedding parameters a = 0.9922 b = 1.112
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
12:35:28 Read 51199 rows and found 30 numeric columns
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
12:35:28 Using Annoy for neighbor search, n_neighbors = 30
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
12:35:28 Building Annoy index with metric = cosine, n_trees = 50
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
0%   10   20   30   40   50   60   70   80   90   100%
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
[----|----|----|----|----|----|----|----|----|----|
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
**************************************************|
12:35:37 Writing NN index file to temp file /tmp/Rtmp3mfWNo/file1b11a852c52
12:35:37 Searching Annoy index using 6 threads, search_k = 3000
12:35:42 Annoy recall = 100%
12:35:44 Commencing smooth kNN distance calibration using 6 threads with target n_neighbors = 30
12:35:45 Initializing from normalized Laplacian + noise (using RSpectra)
12:35:46 Commencing optimization for 200 epochs, with 2530018 positive edges
12:36:09 Optimization finished
```


:::

```{.r .cell-code .hidden}
#| label: transfer-umap
srt.kim <- IntegrateEmbeddings(
  anchorset = hypoth.anchors, reference = srt.romanov.pub, query = srt.kim,
  new.reduction.name = "ref.pca"
)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Requested to reuse weights matrix, but no weights found. Computing new weights.
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: Layer counts isn't present in the assay object; returning NULL
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: Layer counts isn't present in the assay object; returning NULL
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```

Integrating dataset 2 with reference dataset
Finding integration vectors
Finding integration vector weights
Integrating data
```


:::

```{.r .cell-code .hidden}
#| label: transfer-umap
srt.kim <- ProjectUMAP(
  query = srt.kim, query.reduction = "ref.pca", reference = srt.romanov.pub,
  reference.reduction = "pca", reduction.model = "umap"
)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Computing nearest neighbors
Running UMAP projection
12:39:56 Read 128006 rows
12:39:56 Processing block 1 of 1
12:39:56 Commencing smooth kNN distance calibration using 6 threads with target n_neighbors = 30
12:39:57 Initializing by weighted average of neighbor coordinates using 6 threads
12:39:57 Commencing optimization for 67 epochs, with 3840180 positive edges
12:40:25 Finished
```


:::
:::

::: {#cell-fig-reference-umap-transfered .cell}

```{.r .cell-code .hidden}
#| label: fig-reference-umap-transfered
#| fig-cap: "UMAP plot of the Romanov et al. (2020) dataset with reference annotations and transferred labels on the the Kim DW et al. (2020) dataset. Cells are colored by published *wtree* clusters' labels identified as pars tuberalis. Note the successful embedding of query dataset according to the reference dataset and slight change of the reference embedding model in the process."
Idents(srt.romanov.pub) <- "wtree"
p1 <- Cluster_Highlight_Plot(
  seurat_object = srt.romanov.pub,
  reduction = "umap",
  label = TRUE,
  label.size = 3,
  repel = TRUE,
  cluster_name = c("38", "42", "45"),
  highlight_color = srt.romanov.pub@misc$wtree_Colour_Pal[c("38", "42", "45")]
) +
  NoLegend() +
  ggtitle("Reference annotations")

Idents(srt.kim) <- "predicted.id"
p2 <- Cluster_Highlight_Plot(
  seurat_object = srt.kim,
  reduction = "ref.umap",
  label = TRUE,
  label.size = 3,
  repel = TRUE,
  cluster_name = c("38", "42", "45"),
  highlight_color = srt.romanov.pub@misc$wtree_Colour_Pal[c("38", "42", "45")]
) +
  NoLegend() +
  ggtitle("Query transferred labels")
```

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: The following `cluster_name` were omitted as they were not found the
active.ident slot: 42
```


:::

```{.r .cell-code .hidden}
#| label: fig-reference-umap-transfered
#| fig-cap: "UMAP plot of the Romanov et al. (2020) dataset with reference annotations and transferred labels on the the Kim DW et al. (2020) dataset. Cells are colored by published *wtree* clusters' labels identified as pars tuberalis. Note the successful embedding of query dataset according to the reference dataset and slight change of the reference embedding model in the process."
p1 + p2
```

::: {.cell-output-display}
![UMAP plot of the Romanov et al. (2020) dataset with reference annotations and transferred labels on the the Kim DW et al. (2020) dataset. Cells are colored by published *wtree* clusters' labels identified as pars tuberalis. Note the successful embedding of query dataset according to the reference dataset and slight change of the reference embedding model in the process.](01-de_test-focus_pars_tub_files/figure-html/fig-reference-umap-transfered-1.png){#fig-reference-umap-transfered width=672}
:::
:::

::: {#cell-fig-feature-romanov2020-integrated .cell}

```{.r .cell-code .hidden}
#| label: fig-feature-romanov2020-integrated
#| fig.cap: "Feature plot of selected genes in hypothalamus across different developmental stages in the Romanov et al. (2020) dataset (new integrated UMAP embedding). Cells are colored by expression level.  Note the distinct localization patterns of each gene."
#| fig-width: 24
#| fig-height: 36
#| fig-dpi: 90
FeaturePlot(
  srt.romanov.pub,
  features = c(
    "Tshb", "Cck", "Pitx1",
    "Eya1", "Eya2", "Eya3", "Eya4",
    "Sox2", "Hlf", "Tshr",
    "Cckar", "Cckbr", "Gpr173",
    "Foxl2", "Lhx3", "Lhx4", "Pit1", "Gata2"
  ),
  label = F,
  blend = F,
  order = TRUE,
  pt.size = 1.2,
  raster.dpi = c(512, 512),
  alpha = 0.5,
  split.by = "Age"
)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: The following requested variables were not found: Pit1
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
All cells have the same value (0) of "Foxl2"
All cells have the same value (0) of "Foxl2"
All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output-display}
![Feature plot of selected genes in hypothalamus across different developmental stages in the Romanov et al. (2020) dataset (new integrated UMAP embedding). Cells are colored by expression level.  Note the distinct localization patterns of each gene.](01-de_test-focus_pars_tub_files/figure-html/fig-feature-romanov2020-integrated-1.png){#fig-feature-romanov2020-integrated width=2160}
:::
:::





# Calculate and plot chi2 test of independence between Sox2 and Tshr expression in hypothalamus across different developmental stages





::: {.cell}

```{.r .cell-code .hidden}
#| label: get-goi-sox2-tshr
sbs_mtx <- GetAssayData(object = srt.kim, layer = "counts", assay = "RNA")[c("Sox2", "Tshr"), ] %>%
  as.data.frame() %>%
  t() %>%
  as.data.frame() %>%
  select(Sox2, Tshr) %>%
  dplyr::bind_cols(srt.kim@meta.data) %>%
  select(Age, Sox2, Tshr) %>%
  mutate(
    Sox2_pos = Sox2 > 0,
    Tshr_pos = Tshr > 0
  )

sbs_mtx %>% skimr::skim()
```

::: {.cell-output-display}

Table: Data summary

|                         |           |
|:------------------------|:----------|
|Name                     |Piped data |
|Number of rows           |128006     |
|Number of columns        |5          |
|_______________________  |           |
|Column type frequency:   |           |
|factor                   |1          |
|logical                  |2          |
|numeric                  |2          |
|________________________ |           |
|Group variables          |None       |


**Variable type: factor**

|skim_variable | n_missing| complete_rate|ordered | n_unique|top_counts                                    |
|:-------------|---------:|-------------:|:-------|--------:|:---------------------------------------------|
|Age           |         0|             1|FALSE   |       12|P45: 17025, E16: 16781, E14: 16543, P8: 13677 |


**Variable type: logical**

|skim_variable | n_missing| complete_rate| mean|count                   |
|:-------------|---------:|-------------:|----:|:-----------------------|
|Sox2_pos      |         0|             1| 0.14|FAL: 110343, TRU: 17663 |
|Tshr_pos      |         0|             1| 0.00|FAL: 127714, TRU: 292   |


**Variable type: numeric**

|skim_variable | n_missing| complete_rate| mean|   sd| p0| p25| p50| p75| p100|hist  |
|:-------------|---------:|-------------:|----:|----:|--:|---:|---:|---:|----:|:-----|
|Sox2          |         0|             1| 0.27| 1.21|  0|   0|   0|   0|   82|▇▁▁▁▁ |
|Tshr          |         0|             1| 0.00| 0.06|  0|   0|   0|   0|    5|▇▁▁▁▁ |


:::
:::

::: {#cell-fig-sox2-tshr-stats .cell}

```{.r .cell-code .hidden}
#| label: fig-sox2-tshr-stats
#| fig-cap: "Proportion of Sox2 and Tshr expression in hypothalamus across different developmental stages. Cells are colored by Sox2 and Tshr expression status. Note the distinct Sox2 and Tshr expression patterns across different developmental stages."
#| fig-width: 8
#| fig-height: 24
write_csv(sbs_mtx, here(tables_dir, "Sox2-Tshr-expression-status-between-Ages-on-evaluation-datasets.csv"))


# plot
grouped_ggpiestats(
  data = sbs_mtx,
  x = Tshr_pos,
  y = Sox2_pos,
  grouping.var = Age,
  perc.k = 1,
  package = "ggsci",
  palette = "category10_d3",
  title.text = "Sox2 specification of Tshr-positive hypothalamic development",
  caption.text = "Asterisks denote results from proportion tests; \n***: p < 0.001, ns: non-significant",
  plotgrid.args = list(nrow = 8)
)
```

::: {.cell-output-display}
![Proportion of Sox2 and Tshr expression in hypothalamus across different developmental stages. Cells are colored by Sox2 and Tshr expression status. Note the distinct Sox2 and Tshr expression patterns across different developmental stages.](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-tshr-stats-1.png){#fig-sox2-tshr-stats width=768}
:::
:::





## Calculate and plot hexagonal cells representation in hypothalamus across different developmental stages with meta information





::: {.cell}

```{.r .cell-code .hidden}
srt.kim
```

::: {.cell-output .cell-output-stdout}

```
An object of class Seurat 
27998 features across 128006 samples within 1 assay 
Active assay: RNA (27998 features, 5000 variable features)
 3 layers present: counts, data, scale.data
 3 dimensional reductions calculated: umap, ref.pca, ref.umap
```


:::
:::

::: {#cell-fig-hexbin-umap-kim2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-hexbin-umap-kim2020
#| fig-cap: "Hexagonal binning plot of the Kim DW et al. (2020) dataset in the hypothalamus of all developmental stages. Cells are colored by cell count."
library(hexbin)
# Extract UMAP coordinates
umap_coords <- Embeddings(srt.kim, reduction = "ref.umap")

# Create hexbin object
hb <- hexbin(umap_coords[, 1], umap_coords[, 2], xbins = 64)

# Create a data frame for plotting
hex_data <- data.frame(
  x = hcell2xy(hb)$x,
  y = hcell2xy(hb)$y,
  count = hb@count
)

# Create the plot
ggplot(hex_data, aes(x = x, y = y, fill = count)) +
  geom_hex(stat = "identity") +
  scale_fill_gradientn(colors = ggsci::pal_material("amber")(9)) +
  labs(x = "UMAP_1", y = "UMAP_2", fill = "Cell\nCount") +
  coord_fixed()
```

::: {.cell-output-display}
![Hexagonal binning plot of the Kim DW et al. (2020) dataset in the hypothalamus of all developmental stages. Cells are colored by cell count.](01-de_test-focus_pars_tub_files/figure-html/fig-hexbin-umap-kim2020-1.png){#fig-hexbin-umap-kim2020 width=672}
:::
:::

::: {#cell-fig-feature-kim2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-feature-kim2020
#| fig-cap: "Feature plot of selected genes in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset (integrated UMAP embedding). Cells are colored by expression level.  Note the distinct localization patterns of each gene."
#| fig-width: 32
#| fig-height: 36
FeaturePlot(
  srt.kim,
  features = c(
    "Tshb", "Cck", "Pitx1",
    "Eya1", "Eya2", "Eya3", "Eya4",
    "Sox2", "Hlf", "Tshr",
    "Cckar", "Cckbr", "Gpr173",
    "Foxl2", "Lhx3", "Lhx4", "Pit1", "Gata2"
  ),
  reduction = "ref.umap",
  label = F,
  blend = F,
  order = TRUE,
  pt.size = 1.2,
  raster.dpi = c(512, 512),
  alpha = 0.5,
  split.by = "Age"
)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: The following requested variables were not found: Pit1
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Tshb"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cck"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckar"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckbr"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Tshb"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckbr"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Pitx1"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx4"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Cckbr"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx4"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Tshr"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Tshb"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Pitx1"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Pitx1"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Pitx1"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx3"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx4"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx4"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx4"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Foxl2"
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: All cells have the same value (0) of "Lhx4"
```


:::

::: {.cell-output-display}
![Feature plot of selected genes in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset (integrated UMAP embedding). Cells are colored by expression level.  Note the distinct localization patterns of each gene.](01-de_test-focus_pars_tub_files/figure-html/fig-feature-kim2020-1.png){#fig-feature-kim2020 width=3072}
:::
:::

::: {#cell-fig-prediction-scores-kim2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-prediction-scores-kim2020
#| fig-cap: "Feature plot of prediction scores in hypothalamus of all developmental stages in the Kim DW et al. (2020) dataset (integrated UMAP embedding). Cells are colored by prediction score of pars tuberalis identified clusters. Note the distinct localization patterns of prediction score."
#| fig-width: 21
#| fig-height: 5
Idents(srt.kim) <- "predicted.id"
FeaturePlot(
  srt.kim,
  features = c(
    "prediction.score.38",
    "prediction.score.42",
    "prediction.score.45"
  ),
  reduction = "ref.umap",
  label = T,
  repel = T,
  blend = F,
  order = TRUE,
  pt.size = 4,
  raster.dpi = c(512, 512),
  alpha = 0.8,
  max.cutoff = "q90",
  ncol = 3
)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Rasterizing points since number of points exceeds 100,000.
To disable this behavior set `raster=FALSE`
Rasterizing points since number of points exceeds 100,000.
To disable this behavior set `raster=FALSE`
Rasterizing points since number of points exceeds 100,000.
To disable this behavior set `raster=FALSE`
```


:::

::: {.cell-output-display}
![Feature plot of prediction scores in hypothalamus of all developmental stages in the Kim DW et al. (2020) dataset (integrated UMAP embedding). Cells are colored by prediction score of pars tuberalis identified clusters. Note the distinct localization patterns of prediction score.](01-de_test-focus_pars_tub_files/figure-html/fig-prediction-scores-kim2020-1.png){#fig-prediction-scores-kim2020 width=2016}
:::
:::

::: {#cell-fig-prediction-scores-split-kim2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-prediction-scores-split-kim2020
#| fig-cap: "Feature plot of prediction scores in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset (integrated UMAP embedding). Cells are colored by prediction score of pars tuberalis identified clusters. Note the distinct localization patterns of prediction score."
#| fig-width: 32
#| fig-height: 6.353
FeaturePlot(
  srt.kim,
  features = c(
    "prediction.score.38",
    "prediction.score.42",
    "prediction.score.45"
  ),
  reduction = "ref.umap",
  label = F,
  blend = F,
  order = TRUE,
  pt.size = 1.2,
  raster.dpi = c(512, 512),
  alpha = 0.8,
  max.cutoff = "q90",
  split.by = "Age"
)
```

::: {.cell-output-display}
![Feature plot of prediction scores in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset (integrated UMAP embedding). Cells are colored by prediction score of pars tuberalis identified clusters. Note the distinct localization patterns of prediction score.](01-de_test-focus_pars_tub_files/figure-html/fig-prediction-scores-split-kim2020-1.png){#fig-prediction-scores-split-kim2020 width=3072}
:::
:::

::: {#cell-fig-prediction-id-kim2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-prediction-id-kim2020
#| fig-cap: "Feature plot of predicted clusters in hypothalamus of all developmental stages in the Kim DW et al. (2020) dataset (integrated UMAP embedding). Cells are colored by predicted clusters. Note the distinct localization patterns of clusters 38 and 45."
#| fig-width: 7
#| fig-height: 5
DimPlot(
  srt.kim,
  group.by = c("predicted.id"),
  reduction = "ref.umap",
  label = T,
  repel = T,
  pt.size = 4,
  raster.dpi = c(300, 300),
  alpha = 0.5
)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Rasterizing points since number of points exceeds 100,000.
To disable this behavior set `raster=FALSE`
```


:::

::: {.cell-output-display}
![Feature plot of predicted clusters in hypothalamus of all developmental stages in the Kim DW et al. (2020) dataset (integrated UMAP embedding). Cells are colored by predicted clusters. Note the distinct localization patterns of clusters 38 and 45.](01-de_test-focus_pars_tub_files/figure-html/fig-prediction-id-kim2020-1.png){#fig-prediction-id-kim2020 width=672}
:::
:::

::: {#cell-fig-prediction-split-kim2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-prediction-split-kim2020
#| fig-cap: "Feature plot of projected Pars Tuberalis clusters in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset (integrated UMAP embedding). Cells are colored by original colour code of wtree clusters. Note the distinct localization patterns of clusters 38 and 45."
#| fig-width: 14
#| fig-height: 5
p38kim <- Cluster_Highlight_Plot(
  seurat_object = srt.kim,
  reduction = "ref.umap",
  label = TRUE,
  label.size = 1.2,
  repel = TRUE,
  # split.by = "Age",
  cluster_name = "38",
  highlight_color = srt.romanov.pub@misc$wtree_Colour_Pal["38"]
) + NoLegend()

# Not found
# p42kim <- Cluster_Highlight_Plot(
#   seurat_object = srt.kim,
#   reduction = "ref.umap",
#   label = TRUE,
#   label.size = 1.2,
#   repel = TRUE,
#   # split.by = "Age",
#   cluster_name = "42",
#   highlight_color = srt.romanov.pub@misc$wtree_Colour_Pal["42"]
# ) + NoLegend()

p45kim <- Cluster_Highlight_Plot(
  seurat_object = srt.kim,
  reduction = "ref.umap",
  label = TRUE,
  label.size = 1.2,
  repel = TRUE,
  # split.by = "Age",
  cluster_name = "45",
  highlight_color = srt.romanov.pub@misc$wtree_Colour_Pal["45"]
) + NoLegend()

# (p38kim | p42kim | p45kim)
p38kim | p45kim
```

::: {.cell-output-display}
![Feature plot of projected Pars Tuberalis clusters in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset (integrated UMAP embedding). Cells are colored by original colour code of wtree clusters. Note the distinct localization patterns of clusters 38 and 45.](01-de_test-focus_pars_tub_files/figure-html/fig-prediction-split-kim2020-1.png){#fig-prediction-split-kim2020 width=1344}
:::
:::





## Quantify and plot representation of gene interactions with feature expression Spearman’s correlation

### Kim DW et al. 2020 dataset





::: {#cell-fig-violin-gene-interactions-kim2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-violin-gene-interactions-kim2020
#| fig-cap: Gene expression of projected Pars Tuberalis clusters in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset.
#| fig-width: 12
#| fig-height: 12
cells_to_check <- WhichCells(srt.kim, idents = c("38", "42", "45") %>% .[. %in% levels(srt.kim)])
genes_to_check <- c(
  "Tshb",
  "Cck",
  "Pitx1",
  "Eya1",
  "Eya2",
  "Eya3",
  "Eya4",
  "Sox2",
  "Hlf",
  "Tshr",
  "Cckar",
  "Cckbr",
  "Gpr173",
  "Foxl2",
  "Lhx3",
  "Lhx4",
  "Pit1",
  "Gata2"
) %>%
  .[. %in% (srt.kim@assays$RNA@counts[, cells_to_check] |> rowSums() %>% .[. > 3] %>% names())]


# 1. Complete gene pairs - Ensure all combinations are present
gene_pairs <- combn(
  genes_to_check, 2
) |>
  as_tibble() |>
  array_tree(margin = 2)
```

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if
`.name_repair` is omitted as of tibble 2.0.0.
ℹ Using compatibility `.name_repair`.
```


:::

```{.r .cell-code .hidden}
#| label: fig-violin-gene-interactions-kim2020
#| fig-cap: Gene expression of projected Pars Tuberalis clusters in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset.
#| fig-width: 12
#| fig-height: 12
ages <- c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P8", "P45")


# Violin plots of individual gene expression split by cluster
Idents(srt.kim) <- "Age" # Reset identity back to Age

Stacked_VlnPlot(subset(srt.kim, cells = cells_to_check), features = genes_to_check, split.by = "predicted.id", colors_use = srt.romanov.pub@misc$wtree_Colour_Pal[c("38", "42", "45")])
```

::: {.cell-output .cell-output-stderr .hidden}

```
The default behaviour of split.by has changed.
Separate violin plots are now plotted side-by-side.
To restore the old behaviour of a single split violin,
set split.plot = TRUE.
      
This message will be shown once per session.
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
```


:::

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
```


:::

::: {.cell-output-display}
![Gene expression of projected Pars Tuberalis clusters in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset.](01-de_test-focus_pars_tub_files/figure-html/fig-violin-gene-interactions-kim2020-1.png){#fig-violin-gene-interactions-kim2020 width=1152}
:::
:::

::: {.cell .hidden}

```{.r .cell-code .hidden}
#| label: setup-gene-correlation-analysis
#| include: false

# Helper functions
calculate_correlations <- function(seurat_obj, gene_pairs, group_var, cells) {
  map_dfr(gene_pairs, function(genes) {
    data <- seurat_obj |> 
      subset(cells = cells) |> 
      GetAssayData(layer = "data") |> 
      t() |> 
      as.data.frame() |> 
      select(all_of(genes))
    
    groups <- seurat_obj[[group_var]][cells, , drop = FALSE]
    
    # Calculate correlations for each group
    map_dfr(unique(groups[[1]]), function(group) {
      group_cells <- groups[[1]] == group
      group_data <- data[group_cells, ]
      
      # Spearman correlation test
      test_result <- pspearman::spearman.test(
        group_data[[genes[1]]], 
        group_data[[genes[2]]]
      ) |> 
        broom::tidy()
      
      tibble(
        group = group,
        gene1 = genes[1],
        gene2 = genes[2],
        correlation = test_result$estimate,
        p.value = test_result$p.value,
        n = sum(group_cells)
      )
    })
  })
}

generate_correlation_plots <- function(seurat_obj, genes, group_var, cells, age = NULL) {
  plot_data <- seurat_obj |> 
    subset(cells = cells) |> 
    GetAssayData(layer = "data") |> 
    t() |> 
    as.data.frame() |> 
    mutate(group = seurat_obj[[group_var]][cells, 1])
  
  if (!is.null(age)) {
    title <- paste("Gene correlation at", age)
  } else {
    title <- "Gene correlation"
  }
  
  grouped_ggscatterstats(
    data = plot_data,
    x = genes[1],
    y = genes[2],
    grouping.var = group,
    type = "nonparametric",
    xlab = genes[1],
    ylab = genes[2],
    title = title
  )
}
```
:::

::: {.cell}

```{.python .cell-code .hidden}
#| label: generate-kim2020-correlation-plots
#| output: false
#| echo: false

import nbformat
from nbformat.v4 import new_notebook, new_markdown_cell, new_code_cell
import pandas as pd 

# Access R variables in Python using py$
gene_pairs = r.gene_pairs 
ages = r.ages 

# Convert gene_pairs to a Pandas DataFrame
gene_pairs = pd.DataFrame(gene_pairs).T

def generate_plot_chunk(genes, age):
    chunk_text = f'''#| label: fig-kim2020-correlation-{genes[0]}-{genes[1]}-{age}
#| fig-cap: "Correlation between {genes[0]} and {genes[1]} expression at {age} in Kim et al. 2020 dataset"
#| fig-width: 12
#| fig-height: 8

generate_correlation_plots(
  srt.kim |> subset(Age == "{age}"),
  c("{genes[0]}", "{genes[1]}"),
  "predicted.id",
  cells_to_check,
  age = "{age}"
)'''
    return chunk_text

# Generate chunks for each gene pair and age combination
cells = [new_markdown_cell("#### Gene Correlation Plots\n")]

for _, row in gene_pairs.iterrows():
    for age in ages:
        cells.append(new_code_cell(
            generate_plot_chunk([row[0], row[1]], age)
        ))

# Create notebook
nb = new_notebook(cells=cells)
nbformat.write(nb, 'gene_correlation_plots_kim2020.qmd')
```
:::


{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "394aa326",
   "metadata": {},
   "source": [
    "#### Gene Correlation Plots\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6972c86",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cck-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ee7f4012",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cck-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "312a4b39",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cck-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4c341900",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cck-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d9fe30a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cck-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d4ebfe9c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cck-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8cb7acda",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cck-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0e61af46",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cck-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8339e25e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cck-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ac621530",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cck-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "809ac99e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Pitx1-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8d4e152",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Pitx1-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d65fb0bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Pitx1-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b663dd95",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Pitx1-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "86ddf945",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Pitx1-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d2f60cd6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Pitx1-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13963685",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Pitx1-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7ca6436a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Pitx1-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "43f96ade",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Pitx1-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5fd5609c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Pitx1-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a94595f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya1-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3354175b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya1-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "401d4e1b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya1-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "04c9d8d9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya1-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "60550770",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya1-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54aa0971",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f6b3814",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya1-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8daeb3f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya1-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f881cd5c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya1-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "87bc67c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya1-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8d91cc6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya2-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4cee169",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya2-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d286dd7d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya2-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "daf9e46f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya2-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1c0a13ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya2-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7bc4c87a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7df1c571",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya2-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f4a18f71",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya2-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df77e86a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya2-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc039008",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya2-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9ff2e3b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya3-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e9451a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya3-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0ccebc5f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya3-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f12ff42",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya3-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c0f607d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya3-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "db801799",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cdf3043",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya3-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a5dce25c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya3-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58ac9669",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya3-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "244b73f0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya3-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3925c96f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya4-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "81aa464b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya4-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "39c1906e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya4-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3bcb7464",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya4-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9bd75df6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya4-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bafcf0af",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1c37f943",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya4-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a540e725",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya4-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6af499c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya4-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "410fd2cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Eya4-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82037454",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Sox2-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "85744d6b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Sox2-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "65761d61",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Sox2-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3ee80f1c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Sox2-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c069d13f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Sox2-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c3fc3bca",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4c96fd2a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Sox2-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9fefb452",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Sox2-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a1376fa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Sox2-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "32fa7487",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Sox2-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "871e3cc3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Hlf-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6a062dd9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Hlf-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "403e7670",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Hlf-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f97d2e40",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Hlf-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5be8af2a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Hlf-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "da552e6c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3575338c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Hlf-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "869e7abe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Hlf-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "77118de4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Hlf-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e20b78c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Hlf-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49f158ca",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Tshr-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f800037a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Tshr-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "157e7cba",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Tshr-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce4c9f0b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Tshr-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "499800c1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Tshr-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f72e99f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6bc900c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Tshr-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50f5974a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Tshr-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a3474494",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Tshr-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1d4a4918",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Tshr-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "600ffb2f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckar-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Cckar expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ae443ffb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckar-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Cckar expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9f90c79f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckar-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Cckar expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29b0a103",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckar-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Cckar expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61671a15",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckar-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Cckar expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b988c94",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckar-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Cckar expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4285d7eb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckar-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Cckar expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "373586bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckar-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Cckar expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e483e744",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckar-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Cckar expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6bf00dbd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckar-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Cckar expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a03f4630",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fa493284",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "25beec4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3750ec65",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3c8b508c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cdc19d10",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3bcc1ea9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "21236523",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "65627867",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "36c6c1c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5c191729",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "649cae0b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "39a56d4e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b3db8f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be943cb9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c108be87",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8cc9ff88",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bfaefdc0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b1e30919",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed1660c4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3f304df1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a1904fda",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d76162d4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "976361ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "614fc968",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c1785491",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f6323f5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2a762183",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f5876ed8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8919912b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a271d202",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "acd36bf7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a47bb99",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "40630629",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc24684a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc99a67d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8c2c44bc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "72b8d9c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "18c363ba",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e7c7c181",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fce6060b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "84a4880b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0386e816",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6237b4a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2b1aa54a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "afed73b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9aeb2b78",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dafb130d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e97cf62f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a3c3cf1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshb-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5353534b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Pitx1-E10\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "22d5b2c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Pitx1-E11\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c77f9d76",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Pitx1-E12\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0d400d0a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Pitx1-E13\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4dee3ae5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Pitx1-E14\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b2f7175",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Pitx1-E15\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "04e2be66",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Pitx1-E16\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ddc6c535",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Pitx1-E18\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5dd43d81",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Pitx1-P8\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cd02e521",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Pitx1-P45\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f9b5ff9e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya1-E10\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45cf94e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya1-E11\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7bb29b9a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya1-E12\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0ee7487",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya1-E13\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "40d2c2d3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya1-E14\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dbbdce3c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d7e44e00",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya1-E16\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b2f2212b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya1-E18\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2c29dadc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya1-P8\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "33ae849f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya1-P45\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "266eb5c4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya2-E10\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e066b137",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya2-E11\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3d70df5a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya2-E12\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1f2bcdd9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya2-E13\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f4a05191",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya2-E14\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c2ef463f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71d99695",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya2-E16\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35264593",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya2-E18\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "636652c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya2-P8\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f116ae59",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya2-P45\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af6e3a55",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya3-E10\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a1c7e25c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya3-E11\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "272a2e74",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya3-E12\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ae862679",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya3-E13\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d58ee310",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya3-E14\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b79daad8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9fdd8900",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya3-E16\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3eba71a9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya3-E18\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eedfc324",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya3-P8\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "671f76f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya3-P45\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a529a432",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya4-E10\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe36f5f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya4-E11\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "623410c4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya4-E12\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "14c901d6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya4-E13\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "83610977",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya4-E14\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "232747b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8f57bc9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya4-E16\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e1936b33",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya4-E18\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "64e41cdf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya4-P8\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "294f7495",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Eya4-P45\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "33399be6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Sox2-E10\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b4eaf274",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Sox2-E11\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d96d59e3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Sox2-E12\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "36303878",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Sox2-E13\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b4b0909",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Sox2-E14\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "63f2fd3b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bfb6e085",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Sox2-E16\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "83909c49",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Sox2-E18\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6a98c45f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Sox2-P8\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5a9b0cc9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Sox2-P45\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba9a8707",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Hlf-E10\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e8af7e3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Hlf-E11\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ded489f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Hlf-E12\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8b750822",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Hlf-E13\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "459a5f4a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Hlf-E14\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a2b3a1c3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a90aa2c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Hlf-E16\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e4ab48a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Hlf-E18\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "21d3307b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Hlf-P8\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "584e99ec",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Hlf-P45\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "205f8cb7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Tshr-E10\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82e16029",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Tshr-E11\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6820fa89",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Tshr-E12\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d1b60e35",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Tshr-E13\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b8a5225d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Tshr-E14\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29964fbd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8276944b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Tshr-E16\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ee7cb06a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Tshr-E18\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2c9fcb25",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Tshr-P8\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ab4427ec",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Tshr-P45\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "90b2a779",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckar-E10\n",
    "#| fig-cap: \"Correlation between Cck and Cckar expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d29aac22",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckar-E11\n",
    "#| fig-cap: \"Correlation between Cck and Cckar expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0e524630",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckar-E12\n",
    "#| fig-cap: \"Correlation between Cck and Cckar expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb4bc3bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckar-E13\n",
    "#| fig-cap: \"Correlation between Cck and Cckar expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15d20fe1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckar-E14\n",
    "#| fig-cap: \"Correlation between Cck and Cckar expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af33da79",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckar-E15\n",
    "#| fig-cap: \"Correlation between Cck and Cckar expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "152052d7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckar-E16\n",
    "#| fig-cap: \"Correlation between Cck and Cckar expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dbdc99e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckar-E18\n",
    "#| fig-cap: \"Correlation between Cck and Cckar expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a0bfaf80",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckar-P8\n",
    "#| fig-cap: \"Correlation between Cck and Cckar expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b794f508",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckar-P45\n",
    "#| fig-cap: \"Correlation between Cck and Cckar expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6dad2b01",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Cck and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b329ad12",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Cck and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "370fe3e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Cck and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3823a5a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Cck and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8939394b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Cck and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d318deed",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Cck and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9b54aa39",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Cck and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6578ac94",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Cck and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "140933fc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Cck and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a1505453",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Cck and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f4d4c577",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e1de9c2c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57814003",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2fa95c64",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2200c173",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b34cd4e3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13ce4ab1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7024f28e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5ea9d440",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a44e1501",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "09d19cae",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5d26aeb2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e5393c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7765a331",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "322d9662",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "da6b846c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b51429d0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "273b02ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b395346",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57588751",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ca1d3e6d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Cck and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3be7ba06",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Cck and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b4defb35",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Cck and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3de34ec2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Cck and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "006783b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Cck and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e240671c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Cck and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02e1f8c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Cck and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "22ed9360",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Cck and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5555e59e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Cck and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "de1b3b05",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Cck and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "72420a4d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6027a308",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "201a6009",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "89206dfb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e1307e3a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cff1420b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a1adc740",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aa21b686",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5902efbb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cf0e389",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cck-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a2fe7e3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya1-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aadb59c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya1-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3c2e5cff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya1-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "779bd9db",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya1-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c478c4c1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya1-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "79e3195c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e26211e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya1-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4749188e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya1-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49b4e3cd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya1-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e3a385c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya1-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "46961e1c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya2-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb973dfd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya2-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "31349ceb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya2-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3820fb24",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya2-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d5556b3a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya2-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "24f59380",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "19d6d113",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya2-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "516ec586",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya2-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e3e241be",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya2-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc9d3b34",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya2-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a7a56afb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya3-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ae44be53",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya3-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "165ebbef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya3-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "85093dd5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya3-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c08c9d47",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya3-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "97de54d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8f3b1017",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya3-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "da5aeed3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya3-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "34b9b36e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya3-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1a1d3b31",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya3-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e753ace",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya4-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c2c49cf0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya4-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "81f6684e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya4-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a3846e87",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya4-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "27e84425",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya4-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1a8d2036",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "491dd7c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya4-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df23bac0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya4-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "828ea285",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya4-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b6c0f0a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Eya4-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c3eaa51a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Sox2-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "70e072ef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Sox2-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "837361fe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Sox2-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ce8069c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Sox2-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "22fc075f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Sox2-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d0c1a966",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4469ee7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Sox2-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e3ae517",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Sox2-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "46f43c5a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Sox2-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fa9b30f2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Sox2-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7d9d3d29",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Hlf-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4674983e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Hlf-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f05bba9f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Hlf-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "329d0a83",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Hlf-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eba4cda6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Hlf-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8655b85",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "23148f04",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Hlf-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "24cc410f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Hlf-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e0778794",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Hlf-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1f235738",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Hlf-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5d5a19df",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Tshr-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5caa638",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Tshr-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "66b9e1cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Tshr-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "16f950f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Tshr-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8cfb224a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Tshr-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "404d32c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3d89d6d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Tshr-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58cf8200",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Tshr-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2b3c365a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Tshr-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35b3b87c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Tshr-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a732bb79",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckar-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckar expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4573e42d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckar-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckar expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "334d5fa5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckar-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckar expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "08673d05",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckar-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckar expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c5c7be78",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckar-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckar expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e7958f57",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckar-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckar expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e367ea64",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckar-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckar expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "438506a7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckar-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckar expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8710219a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckar-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckar expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "09567aac",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckar-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckar expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e7c8f4b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61a1cde9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6534b134",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d2c69a26",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5c022c18",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5065fe9b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "24dab4a9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5cb20c12",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "417b448f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4a901840",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b9c6960",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b31df313",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "587a2693",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ea2bb134",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1733a627",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4ca9e7e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3c1abd3c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe372531",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7196ec1c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "74a84f9c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6e035ba3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e7bdd37",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3f4cb0d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3be59413",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "352e1cc9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5c2c40cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eaecdfa1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "596a068e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df9dd8af",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a66bcd9a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "89b391a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cb411ac7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6bd70885",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "486496de",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13a55e1e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8647d918",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3f8da65f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "716bd498",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8b61620c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "844f66fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29776be5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d6f3b77",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e05b5b46",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e300191e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "72dab57c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e78848b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f5489598",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "64104156",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "444b6399",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a14f677",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Pitx1-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1ae7d9e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya2-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61d2b478",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya2-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e4536c30",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya2-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b9bb809",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya2-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4fed996",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya2-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1d06119a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c05164c1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya2-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75e39e82",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya2-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "63b323e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya2-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "67b22e10",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya2-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95d88dd7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya3-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b824d30",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya3-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b8559c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya3-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "da92b93b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya3-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75cc30da",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya3-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4c2fca79",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "70c158a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya3-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "220d9aaf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya3-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1354eca3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya3-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5a9f8ed0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya3-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6a00818a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya4-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cbae6196",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya4-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4ac7d30d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya4-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bf235fa8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya4-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2561276f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya4-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a678041e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed4b82a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya4-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc8013d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya4-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "252ba1a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya4-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d2d263f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Eya4-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "93dd9123",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Sox2-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2bee1103",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Sox2-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "33a142e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Sox2-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9c9b240",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Sox2-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4b8bb2aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Sox2-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9fb82a66",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "294e4e29",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Sox2-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3f128167",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Sox2-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d1a6f23d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Sox2-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "306c6817",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Sox2-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d01ba9b5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Hlf-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eca5e6c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Hlf-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "59db28d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Hlf-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c47dda90",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Hlf-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8f88a9d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Hlf-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e2d45fc3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba6762a9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Hlf-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a8e6166c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Hlf-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1cecf466",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Hlf-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e2e3a8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Hlf-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "79d82de9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Tshr-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b0199e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Tshr-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1f3566e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Tshr-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "062bcd06",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Tshr-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4f74bc13",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Tshr-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c63069aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "55ae7938",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Tshr-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e63b92f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Tshr-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "39eb4c0a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Tshr-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc8fbfa1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Tshr-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "167efb52",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckar-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckar expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "199bf414",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckar-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckar expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a8890358",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckar-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckar expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e0fcb2e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckar-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckar expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5eee981",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckar-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckar expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "396325aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckar-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckar expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "90e65c86",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckar-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckar expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "53061e23",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckar-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckar expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "128ed15e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckar-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckar expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "de4bd42a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckar-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckar expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0d19f17b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e1e362b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "16e284f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02670f67",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "afd42039",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "963b3d82",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b868731a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "86b0de80",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45869b2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9d6b9166",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eeaf9963",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "70578ee0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "14d0299f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5896a39c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "244420cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a0a7401f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "967244f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6b2ee3b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "717194ac",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2646d3d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d2f1fb45",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0d3bab12",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f40023ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c2667793",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f5ec5a7a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c05289a4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e57e77e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "757044fe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "72c2a3d6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "25df1f8b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "824da3af",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "657c6827",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cdefbed9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "78ce7d1b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1958ee8e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7d97a50c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a18da8dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50407335",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "feb28436",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1aef8915",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce020f29",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5c9666da",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2519c6c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "65496d69",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c13f03cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f2097915",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5849f12",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "db0b16ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "79c0233c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9562dd2f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya1-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0324f549",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya3-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a475021b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya3-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eba9e175",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya3-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0929231d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya3-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "96489e3e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya3-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "631b699a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c50bd89a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya3-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4dcbdab8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya3-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61e7f71c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya3-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "91186e5f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya3-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "573e9db8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya4-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6600e9e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya4-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75bad279",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya4-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0031f152",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya4-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0a76e774",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya4-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "20a9bab2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49316fe4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya4-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e949208",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya4-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "565a02d3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya4-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3688c384",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Eya4-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "90384bc1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Sox2-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "64fb4de5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Sox2-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "23bd8039",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Sox2-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d5a07da5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Sox2-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c7eeef95",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Sox2-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45ab3f5e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ea841758",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Sox2-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ca66506f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Sox2-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00944fc0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Sox2-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c64ac0f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Sox2-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a5c72f31",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Hlf-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3114cbeb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Hlf-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f988af7e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Hlf-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d91c85f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Hlf-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8f64a9be",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Hlf-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c28a4a13",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6dff4177",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Hlf-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "85951df9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Hlf-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "792741b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Hlf-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b8fedfb3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Hlf-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1d3bc7c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Tshr-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f9e70dfb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Tshr-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed6edeb7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Tshr-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e7992ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Tshr-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41381f09",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Tshr-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6c59811c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e761a79",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Tshr-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6ea5e8a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Tshr-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1bb5572e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Tshr-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c6c6a216",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Tshr-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c2a5384c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckar-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckar expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e44b80f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckar-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckar expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "09563c1a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckar-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckar expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "67b577f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckar-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckar expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3febb85b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckar-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckar expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "857de94d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckar-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckar expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8058e8e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckar-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckar expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8d3b315b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckar-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckar expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df9bbb50",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckar-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckar expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d01b32d7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckar-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckar expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bd766187",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a6665dda",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df850335",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b199a448",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "717e04f5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "524acabf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1094b191",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5084af38",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8f44d6d0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d03b7c5c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3009facb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fee62ebe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6603ad15",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0703ceb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "39457eb1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f0f88496",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4f33b3c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bfc106e3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6a33a91c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e592ebc9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6221aa21",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0c02ccbc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5463e02c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9f546d93",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "52fc855f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e248400f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2347b066",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "59aedf5d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71d1a5c3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5c346c11",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "04c3e085",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a6c0195a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2b973ad3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "371a43bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6fa8fe91",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f2efc6ec",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2c87ef1f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f04bc287",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "db008a96",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2da13d1e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fc813304",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "318155c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "99f96aa4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b2805a52",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "444176ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "66f03811",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8d152904",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e5c8766",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cd12f39d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aac59161",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya2-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c7cab915",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Eya4-E10\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc11c221",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Eya4-E11\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95fd7dfe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Eya4-E12\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "235faf5d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Eya4-E13\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be09aadb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Eya4-E14\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "79d9ae5f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "088fb943",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Eya4-E16\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9335fd31",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Eya4-E18\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "06096402",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Eya4-P8\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d2f012e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Eya4-P45\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "823d8d68",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Sox2-E10\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0ce48f0f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Sox2-E11\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "62c67e05",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Sox2-E12\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dd160fee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Sox2-E13\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "da13143b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Sox2-E14\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a2642514",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3d048c80",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Sox2-E16\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f7fb6c66",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Sox2-E18\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e568b2d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Sox2-P8\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "370bb9c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Sox2-P45\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c6c93528",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Hlf-E10\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1d95fa25",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Hlf-E11\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "23d48874",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Hlf-E12\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d7d6c702",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Hlf-E13\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e62ea4c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Hlf-E14\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b157edcf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e5444b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Hlf-E16\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "87188140",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Hlf-E18\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2bae286d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Hlf-P8\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a4480574",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Hlf-P45\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54050d49",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Tshr-E10\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "26e6ca2b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Tshr-E11\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6da70d67",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Tshr-E12\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a1c7ee07",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Tshr-E13\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "63b87a24",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Tshr-E14\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7619c41c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8366f4c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Tshr-E16\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0169dc4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Tshr-E18\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "863012e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Tshr-P8\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "56415f2f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Tshr-P45\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f5b714b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckar-E10\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckar expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya3\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13c311c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckar-E11\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckar expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya3\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bcd9230e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckar-E12\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckar expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya3\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "866a849b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckar-E13\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckar expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya3\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6615eabb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckar-E14\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckar expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya3\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d068990a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckar-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckar expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ef84cd28",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckar-E16\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckar expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya3\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a0cda773",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckar-E18\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckar expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya3\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2caef71d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckar-P8\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckar expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya3\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "70901567",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckar-P45\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckar expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya3\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d51be39",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya3\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58caece7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya3\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9fc7a3b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya3\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57d85269",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya3\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1c82ab47",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya3\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "be06e4c4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6ec82d8d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya3\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1eaaf07f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya3\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c5ca1740",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya3\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df2134cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Eya3 and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya3\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "24d1417b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35cc7c8a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "97f7a109",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "574e268e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fcfd8af1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b965fce9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aa2362f9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4969fdb2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "014dcac3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "699e4c0d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce820a14",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "088894bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cca182db",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e0172381",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b26ea585",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b9813502",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ab005cb2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df38dc25",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb600ba6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3455c735",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "11a63a68",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6de22add",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cf7430b7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd129963",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "86cbaf8e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cd5c935b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2ce15235",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4284d5db",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ab64a54e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f319356e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a3547727",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6b401b45",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a5be8ae",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a3748d6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e41ce17",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7c19636e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d1dd7778",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "caefc4d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4dd0de32",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0fccada8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya3-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13f16e21",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Sox2-E10\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2c1d7708",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Sox2-E11\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1f77eee1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Sox2-E12\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f205c4d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Sox2-E13\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "73f65c98",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Sox2-E14\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9a67f6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e18962c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Sox2-E16\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4c451627",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Sox2-E18\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "92963a6d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Sox2-P8\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ccbcd86b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Sox2-P45\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "85484a79",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Hlf-E10\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3644a726",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Hlf-E11\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "930ac340",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Hlf-E12\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "48e805a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Hlf-E13\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a536446c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Hlf-E14\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "28b0a4ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c77d9e73",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Hlf-E16\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5bbf8932",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Hlf-E18\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f727b9d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Hlf-P8\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ca2385e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Hlf-P45\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "18605636",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Tshr-E10\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "025fb5e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Tshr-E11\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29422eb2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Tshr-E12\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c48ac1cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Tshr-E13\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a853c3a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Tshr-E14\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cef4a639",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a456a4ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Tshr-E16\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8af13934",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Tshr-E18\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cc4b2f9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Tshr-P8\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e8f0c19",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Tshr-P45\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9e3afac0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckar-E10\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckar expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya4\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "374adabf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckar-E11\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckar expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya4\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a48f7437",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckar-E12\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckar expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya4\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c5bf15bd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckar-E13\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckar expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya4\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df1b728a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckar-E14\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckar expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya4\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95665d6f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckar-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckar expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "07cc05ab",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckar-E16\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckar expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya4\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ab83a538",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckar-E18\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckar expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya4\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "803ca75a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckar-P8\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckar expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya4\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c43d89ed",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckar-P45\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckar expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya4\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6f355875",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya4\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6e33b447",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya4\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d21aed5d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya4\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc386c52",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya4\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49f8ef07",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya4\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9b2d10c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c870916d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya4\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "efeb99aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya4\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b9e3aa0c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya4\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "11efb75c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Eya4 and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya4\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b4361cc8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1bbb4c1a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "913ead4f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "73c205ca",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e158c5a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "66b31c11",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "72317b6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bdf713d4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d31fe32b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41ae5b0c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8486960",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fdc876d9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8a255d3a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "153806cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "471a6367",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af0c71a4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "78cec77c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "25c9ca1f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2b228933",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "56621ad9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5662e468",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya4\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58f83cb7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya4\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f3b35036",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya4\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d57c50a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya4\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "034b95e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya4\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6e30b24a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec412cdc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya4\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d293b2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya4\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec88fb6d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya4\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e00cb9a1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya4\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a694bcb9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "981f17e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a4cf57a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2cbecf2c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "81756bcb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75b14dd2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7bf423cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b2876391",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2dd31c76",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "068cffcf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Eya4-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0de40859",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Hlf-E10\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f405b8e7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Hlf-E11\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8b911646",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Hlf-E12\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a016b4cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Hlf-E13\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "98b9fa8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Hlf-E14\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e4d8084",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "36b19f32",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Hlf-E16\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57268223",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Hlf-E18\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6ff1dc17",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Hlf-P8\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "053512d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Hlf-P45\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3626fd63",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Tshr-E10\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f34538b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Tshr-E11\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0bc8fb69",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Tshr-E12\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "858d9def",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Tshr-E13\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2af811d3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Tshr-E14\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7534d2a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7791bb6f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Tshr-E16\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "42a6361b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Tshr-E18\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bca20447",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Tshr-P8\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "20534016",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Tshr-P45\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9ecc9db",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckar-E10\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckar expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Sox2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6d743400",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckar-E11\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckar expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Sox2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "28a7e40a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckar-E12\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckar expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Sox2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "27cb2ef8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckar-E13\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckar expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Sox2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bd9cec5a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckar-E14\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckar expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Sox2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e7017cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckar-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckar expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dd4e9ea3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckar-E16\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckar expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Sox2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a96713f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckar-E18\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckar expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Sox2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "198ce3ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckar-P8\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckar expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Sox2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d8e2f14a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckar-P45\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckar expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Sox2\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "879f4ea3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Sox2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f079f969",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Sox2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "902f6594",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Sox2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ca90c59f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Sox2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc9b860c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Sox2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1250f4c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ad04d86e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Sox2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7134edf3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Sox2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ad917e1e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Sox2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e26a4b90",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Sox2 and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Sox2\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b7224a5b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0ee83184",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f48b6403",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e11aeedb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6e60c081",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b2695c1b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bc6cf4dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ae3a068b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e3a8296f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "25db0674",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c94b1fcd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f1159af",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0908a490",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "077f2633",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "710a24dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6b2b95cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c75b1b01",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "46db3d83",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "37436add",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bf1a6f8a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5a62f8e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Sox2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "252c6f89",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Sox2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8c71efe2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Sox2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f727f364",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Sox2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bc0fee04",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Sox2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4b451774",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7291bad7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Sox2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15fbbf68",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Sox2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "088cf763",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Sox2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f452bc1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Sox2\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f1291253",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e60f9e79",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00cc9c2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0ef40fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "db3d3e4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aeabe0c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6d7cf07e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a8c133e7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2f8b7c1f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd617153",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Sox2-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cbdfed2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Tshr-E10\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7920f600",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Tshr-E11\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3d159f66",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Tshr-E12\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f1de6903",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Tshr-E13\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ae2e76ef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Tshr-E14\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "de9add4a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a7d6e5aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Tshr-E16\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2cca12db",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Tshr-E18\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f6dc0fc5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Tshr-P8\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fcf31037",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Tshr-P45\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d670d86",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckar-E10\n",
    "#| fig-cap: \"Correlation between Hlf and Cckar expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Hlf\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "915cd041",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckar-E11\n",
    "#| fig-cap: \"Correlation between Hlf and Cckar expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Hlf\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f619d26c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckar-E12\n",
    "#| fig-cap: \"Correlation between Hlf and Cckar expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Hlf\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "53182a0d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckar-E13\n",
    "#| fig-cap: \"Correlation between Hlf and Cckar expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Hlf\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc8f376a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckar-E14\n",
    "#| fig-cap: \"Correlation between Hlf and Cckar expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Hlf\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1024b74c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckar-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Cckar expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9daa985",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckar-E16\n",
    "#| fig-cap: \"Correlation between Hlf and Cckar expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Hlf\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b968401",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckar-E18\n",
    "#| fig-cap: \"Correlation between Hlf and Cckar expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Hlf\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d0768858",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckar-P8\n",
    "#| fig-cap: \"Correlation between Hlf and Cckar expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Hlf\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "abf7442c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckar-P45\n",
    "#| fig-cap: \"Correlation between Hlf and Cckar expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Hlf\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "52e01cc3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Hlf and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Hlf\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "06bcc393",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Hlf and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Hlf\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a7c7fc59",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Hlf and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Hlf\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "07f2e444",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Hlf and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Hlf\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec544366",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Hlf and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Hlf\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "795616ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45b288ae",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Hlf and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Hlf\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6869b5f0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Hlf and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Hlf\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "235e83d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Hlf and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Hlf\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cf19d477",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Hlf and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Hlf\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2b68873e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8d6a635d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7c71f533",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e282f59",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3979b80f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9408d9e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d7f2805",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50d3bb07",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4ce50d40",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ecef6eab",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a2aacbf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "38ae35b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0620f29b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6abb6aae",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "74967ebe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58b2d4d0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d93b8a00",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aa7b249c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1f16a7a8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bc912d0c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29c98e2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Hlf\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5ff8f7c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Hlf\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7f55741b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Hlf\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5441db86",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Hlf\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "98ea5c57",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Hlf\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8bffa794",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "24990eaa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Hlf\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9615f90a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Hlf\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75226408",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Hlf\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e296215",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Hlf\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5886b022",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9e730786",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8d137aff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f248ebb7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "42fe58e3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e5c872a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb3bbfd6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "67970c12",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8f244a5c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2ee94fef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Hlf-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "03213577",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckar-E10\n",
    "#| fig-cap: \"Correlation between Tshr and Cckar expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshr\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c2f8fac3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckar-E11\n",
    "#| fig-cap: \"Correlation between Tshr and Cckar expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshr\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "783e4742",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckar-E12\n",
    "#| fig-cap: \"Correlation between Tshr and Cckar expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshr\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61704947",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckar-E13\n",
    "#| fig-cap: \"Correlation between Tshr and Cckar expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshr\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0223020b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckar-E14\n",
    "#| fig-cap: \"Correlation between Tshr and Cckar expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshr\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f40922ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckar-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Cckar expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fa022275",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckar-E16\n",
    "#| fig-cap: \"Correlation between Tshr and Cckar expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshr\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b95ddab",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckar-E18\n",
    "#| fig-cap: \"Correlation between Tshr and Cckar expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshr\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b3ff09d0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckar-P8\n",
    "#| fig-cap: \"Correlation between Tshr and Cckar expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshr\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "100964fa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckar-P45\n",
    "#| fig-cap: \"Correlation between Tshr and Cckar expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshr\", \"Cckar\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a617db2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Tshr and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshr\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9218474c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Tshr and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshr\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "30a1c587",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Tshr and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshr\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8c7886a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Tshr and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshr\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af2cc88c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Tshr and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshr\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "62f36373",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1844f9f5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Tshr and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshr\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e56cd9d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Tshr and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshr\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "980e6abb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Tshr and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshr\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a46e840",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Tshr and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshr\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d1f94a58",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9ea6ef86",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b8ecc285",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9764ee0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58e09963",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e0de2855",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "36fe69a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bb2b20ca",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "38bde53b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fcf6c474",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b7184b8a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c55b849a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "36d786b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7fd94ac4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "38ca3b8d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "22da4a2c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ff1849ef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "38e11240",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "92f7878d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49558fc1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41134552",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4ded1c00",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ef32309",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "959f663b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "004ebe45",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "37953872",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f06c1969",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "277095b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9d9d1cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d87cb9bd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f74208c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "555b4495",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "11756ba3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ace4dc59",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "34a8e821",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35edd1a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb0cc226",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4b1f765",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2feb3085",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5ae7c91",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Tshr-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f42f236b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Cckbr-E10\n",
    "#| fig-cap: \"Correlation between Cckar and Cckbr expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cckar\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75d97d4a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Cckbr-E11\n",
    "#| fig-cap: \"Correlation between Cckar and Cckbr expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cckar\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "befce5e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Cckbr-E12\n",
    "#| fig-cap: \"Correlation between Cckar and Cckbr expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cckar\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "73280868",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Cckbr-E13\n",
    "#| fig-cap: \"Correlation between Cckar and Cckbr expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cckar\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af44891c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Cckbr-E14\n",
    "#| fig-cap: \"Correlation between Cckar and Cckbr expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cckar\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "17a4657e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Cckbr-E15\n",
    "#| fig-cap: \"Correlation between Cckar and Cckbr expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cckar\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a8318b78",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Cckbr-E16\n",
    "#| fig-cap: \"Correlation between Cckar and Cckbr expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cckar\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35b3a7a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Cckbr-E18\n",
    "#| fig-cap: \"Correlation between Cckar and Cckbr expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cckar\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eea54d71",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Cckbr-P8\n",
    "#| fig-cap: \"Correlation between Cckar and Cckbr expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cckar\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "26293aea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Cckbr-P45\n",
    "#| fig-cap: \"Correlation between Cckar and Cckbr expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cckar\", \"Cckbr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "833729ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Cckar and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cckar\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e218bca9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Cckar and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cckar\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "645acd8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Cckar and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cckar\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "162070c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Cckar and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cckar\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5ee475f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Cckar and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cckar\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9e597b24",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Cckar and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cckar\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "552aadcb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Cckar and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cckar\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a936900e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Cckar and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cckar\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5326bf36",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Cckar and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cckar\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f12757e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Cckar and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cckar\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d57c8c8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cckar\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4be28f59",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cckar\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b7b9afd9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cckar\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54f9dee7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cckar\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9a1b956",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cckar\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9f9e49d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cckar\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2247a7bd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cckar\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a76fff5f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cckar\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b657b060",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cckar\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41814dea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cckar\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9d0914ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cckar\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "44eacd5d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cckar\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c811fc9d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cckar\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a4c4690e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cckar\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9607df70",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cckar\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d26f27b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cckar\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9aef1758",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cckar\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e3b9a58",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cckar\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1ca88ce9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cckar\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "98417a9e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Cckar and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cckar\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1c017c47",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Cckar and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cckar\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ff6b5f1a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Cckar and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cckar\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6a5c3ad3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Cckar and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cckar\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "652546cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Cckar and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cckar\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb91ea89",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Cckar and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cckar\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a319514",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Cckar and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cckar\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45d270ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Cckar and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cckar\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "12d6941e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Cckar and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cckar\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dccd0df6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Cckar and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cckar\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5026817f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckar-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Cckar and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cckar\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cd1f9fae",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gpr173-E10\n",
    "#| fig-cap: \"Correlation between Cckbr and Gpr173 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cckbr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "190ca13a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gpr173-E11\n",
    "#| fig-cap: \"Correlation between Cckbr and Gpr173 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cckbr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a11a51fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gpr173-E12\n",
    "#| fig-cap: \"Correlation between Cckbr and Gpr173 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cckbr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d64b542b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gpr173-E13\n",
    "#| fig-cap: \"Correlation between Cckbr and Gpr173 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cckbr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cbc4d8d6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gpr173-E14\n",
    "#| fig-cap: \"Correlation between Cckbr and Gpr173 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cckbr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2fd4aa65",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Cckbr and Gpr173 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cckbr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "297cd64c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gpr173-E16\n",
    "#| fig-cap: \"Correlation between Cckbr and Gpr173 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cckbr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9f2d48a7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gpr173-E18\n",
    "#| fig-cap: \"Correlation between Cckbr and Gpr173 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cckbr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "34581e89",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gpr173-P8\n",
    "#| fig-cap: \"Correlation between Cckbr and Gpr173 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cckbr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "83d21384",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gpr173-P45\n",
    "#| fig-cap: \"Correlation between Cckbr and Gpr173 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cckbr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cdf51a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cckbr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec255dda",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cckbr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00e447ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cckbr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "da269055",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cckbr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c44ed475",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cckbr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d6cd9e1b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cckbr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e0da6b90",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cckbr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2ecbf1e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cckbr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cd08e214",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cckbr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9be59235",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cckbr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3d559ff2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cckbr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45a3b05a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cckbr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "19176638",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cckbr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a0a92f6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cckbr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c91f8734",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cckbr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f0fea405",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cckbr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7f257fcc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cckbr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "38258d9a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cckbr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a024e30c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cckbr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0deaf81e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Cckbr and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cckbr\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4ebd21b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Cckbr and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Cckbr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e4d8305b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Cckbr and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Cckbr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "651a5718",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Cckbr and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Cckbr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec1237ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Cckbr and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Cckbr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed895ead",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Cckbr and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Cckbr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "20e96b4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Cckbr and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Cckbr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cb428967",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Cckbr and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Cckbr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb1e7cc5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Cckbr and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Cckbr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "67d33053",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Cckbr and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Cckbr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2b55fed3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Cckbr-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Cckbr and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Cckbr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95239e8a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx3-E10\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2766802f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx3-E11\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b711e9d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx3-E12\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4097c425",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx3-E13\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "616109b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx3-E14\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4ef5b0d6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0ed09def",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx3-E16\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe24335b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx3-E18\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d4746311",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx3-P8\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "39d479c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx3-P45\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4062f173",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Gpr173\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "338eda48",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Gpr173\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "168457f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Gpr173\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1a78dc6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Gpr173\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ca171ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Gpr173\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "010e1a67",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Gpr173\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0bd2622f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Gpr173\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "131ce198",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Gpr173\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "53dfa1dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Gpr173\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d81b6456",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Gpr173\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "86c71989",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35c4268d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0fd428a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b432c84f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "327db81f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2bf77107",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "46e8b9a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "09d3b936",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f2cbabe6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eed233fd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Gpr173-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "07a0cb26",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Lhx4-E10\n",
    "#| fig-cap: \"Correlation between Lhx3 and Lhx4 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Lhx3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af3bd20a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Lhx4-E11\n",
    "#| fig-cap: \"Correlation between Lhx3 and Lhx4 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Lhx3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ab07c9c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Lhx4-E12\n",
    "#| fig-cap: \"Correlation between Lhx3 and Lhx4 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Lhx3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "512a7898",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Lhx4-E13\n",
    "#| fig-cap: \"Correlation between Lhx3 and Lhx4 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Lhx3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "43a40d6f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Lhx4-E14\n",
    "#| fig-cap: \"Correlation between Lhx3 and Lhx4 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Lhx3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e56ccb4d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Lhx4-E15\n",
    "#| fig-cap: \"Correlation between Lhx3 and Lhx4 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Lhx3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "304c382b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Lhx4-E16\n",
    "#| fig-cap: \"Correlation between Lhx3 and Lhx4 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Lhx3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f16ea8e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Lhx4-E18\n",
    "#| fig-cap: \"Correlation between Lhx3 and Lhx4 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Lhx3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5e6ce280",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Lhx4-P8\n",
    "#| fig-cap: \"Correlation between Lhx3 and Lhx4 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Lhx3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57ead507",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Lhx4-P45\n",
    "#| fig-cap: \"Correlation between Lhx3 and Lhx4 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Lhx3\", \"Lhx4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7212384e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5683d574",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f52b5b09",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b10acd8d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec3a520d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b90f63f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e3738a63",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c34daf06",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3c5c2923",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4b73b6f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx3-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "40cb58cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx4-Gata2-E10\n",
    "#| fig-cap: \"Correlation between Lhx4 and Gata2 expression at E10 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E10\"),\n",
    "  c(\"Lhx4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f54cf90f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx4-Gata2-E11\n",
    "#| fig-cap: \"Correlation between Lhx4 and Gata2 expression at E11 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E11\"),\n",
    "  c(\"Lhx4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E11\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ef44a8ca",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx4-Gata2-E12\n",
    "#| fig-cap: \"Correlation between Lhx4 and Gata2 expression at E12 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E12\"),\n",
    "  c(\"Lhx4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E12\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6d6cefe4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx4-Gata2-E13\n",
    "#| fig-cap: \"Correlation between Lhx4 and Gata2 expression at E13 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E13\"),\n",
    "  c(\"Lhx4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E13\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dad95e3e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx4-Gata2-E14\n",
    "#| fig-cap: \"Correlation between Lhx4 and Gata2 expression at E14 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E14\"),\n",
    "  c(\"Lhx4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E14\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d97efc93",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx4-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Lhx4 and Gata2 expression at E15 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E15\"),\n",
    "  c(\"Lhx4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2b148d72",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx4-Gata2-E16\n",
    "#| fig-cap: \"Correlation between Lhx4 and Gata2 expression at E16 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E16\"),\n",
    "  c(\"Lhx4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E16\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50181489",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx4-Gata2-E18\n",
    "#| fig-cap: \"Correlation between Lhx4 and Gata2 expression at E18 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"E18\"),\n",
    "  c(\"Lhx4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E18\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6e6223f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx4-Gata2-P8\n",
    "#| fig-cap: \"Correlation between Lhx4 and Gata2 expression at P8 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P8\"),\n",
    "  c(\"Lhx4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P8\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1086e7ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-kim2020-correlation-Lhx4-Gata2-P45\n",
    "#| fig-cap: \"Correlation between Lhx4 and Gata2 expression at P45 in Kim et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.kim |> subset(Age == \"P45\"),\n",
    "  c(\"Lhx4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P45\"\n",
    ")"
   ]
  }
 ],
 "metadata": {},
 "nbformat": 4,
 "nbformat_minor": 5
}





#### Dotplots





::: {#cell-fig-dotplot-dendrogram-genes-kim2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-dotplot-dendrogram-genes-kim2020
#| fig-cap: "Dotplot of selected genes in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset. Cells are colored by expression level.  Note the distinct localization patterns of each gene."
#| fig-width: 6
#| fig-height: 6
Idents(srt.kim) <- "Age"

DotPlot_scCustom(seurat_object = subset(srt.kim, cells = cells_to_check), colors_use = viridis(n = 30, alpha = .75, direction = -1, option = "E"), features = genes_to_check, flip_axes = T, x_lab_rotate = TRUE, dot.scale = 15)
```

::: {.cell-output-display}
![Dotplot of selected genes in hypothalamus across different developmental stages in the Kim DW et al. (2020) dataset. Cells are colored by expression level.  Note the distinct localization patterns of each gene.](01-de_test-focus_pars_tub_files/figure-html/fig-dotplot-dendrogram-genes-kim2020-1.png){#fig-dotplot-dendrogram-genes-kim2020 width=576}
:::
:::





### Romanov et al. 2020 dataset





::: {#cell-fig-violin-gene-interactions-romanov2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-violin-gene-interactions-romanov2020
#| fig-cap: Gene expression of projected Pars Tuberalis clusters in hypothalamus across different developmental stages in the Romanov et al. (2020) dataset.
#| fig-width: 12
#| fig-height: 12
# Violin plots for srt.romanov.pub (split by its original clusters, 'wtree')
Idents(srt.romanov.pub) <- "wtree"
cells_to_check <- WhichCells(srt.romanov.pub, idents = c("38", "42", "45") %>% .[. %in% levels(srt.romanov.pub)])
genes_to_check <- c(
  "Tshb",
  "Cck",
  "Pitx1",
  "Eya1",
  "Eya2",
  "Eya3",
  "Eya4",
  "Sox2",
  "Hlf",
  "Tshr",
  "Cckar",
  "Cckbr",
  "Gpr173",
  "Foxl2",
  "Lhx3",
  "Lhx4",
  "Pit1",
  "Gata2"
) %>%
  .[. %in% (srt.romanov.pub@assays$RNA@counts[, cells_to_check] |> rowSums() %>% .[. > 3] %>% names())]


# Complete gene pairs
gene_pairs <- combn(
  genes_to_check, 2
) |>
  as_tibble() |>
  array_tree(margin = 2)

ages <- srt.romanov.pub$Age |>
  table() %>%
  .[. > 0] %>%
  names()

# Violin plots of individual gene expression split by cluster
Idents(srt.romanov.pub) <- "Age" # Reset identity back to Age

Stacked_VlnPlot(subset(srt.romanov.pub, cells = cells_to_check), features = genes_to_check, split.by = "wtree", colors_use = srt.romanov.pub@misc$wtree_Colour_Pal[c("38", "42", "45")])
```

::: {.cell-output .cell-output-stderr .hidden}

```
Warning: Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.
```


:::

::: {.cell-output-display}
![Gene expression of projected Pars Tuberalis clusters in hypothalamus across different developmental stages in the Romanov et al. (2020) dataset.](01-de_test-focus_pars_tub_files/figure-html/fig-violin-gene-interactions-romanov2020-1.png){#fig-violin-gene-interactions-romanov2020 width=1152}
:::
:::

::: {.cell}

```{.python .cell-code .hidden}
#| label: generate-romanov2020-correlation-plots
#| output: false
#| echo: false

import nbformat
from nbformat.v4 import new_notebook, new_markdown_cell, new_code_cell
import pandas as pd 

# Access R variables in Python using py$
gene_pairs = r.gene_pairs 
ages = r.ages 

# Convert gene_pairs to a Pandas DataFrame
gene_pairs = pd.DataFrame(gene_pairs).T

def generate_plot_chunk(genes, age):
    chunk_text = f'''#| label: fig-romanov2020-correlation-{genes[0]}-{genes[1]}-{age}
#| fig-cap: "Correlation between {genes[0]} and {genes[1]} expression at {age} in Romanov et al. 2020 dataset"
#| fig-width: 12
#| fig-height: 8

generate_correlation_plots(
  srt.romanov.pub |> subset(Age == "{age}"),
  c("{genes[0]}", "{genes[1]}"),
  "predicted.id",
  cells_to_check,
  age = "{age}"
)'''
    return chunk_text

# Generate chunks for each gene pair and age combination
cells = [new_markdown_cell("#### Gene Correlation Plots\n")]

for _, row in gene_pairs.iterrows():
    for age in ages:
        cells.append(new_code_cell(
            generate_plot_chunk([row[0], row[1]], age)
        ))

# Create notebook
nb = new_notebook(cells=cells)
nbformat.write(nb, 'gene_correlation_plots_romanov2020.qmd')
```
:::


{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "b5ef8a4e",
   "metadata": {},
   "source": [
    "#### Gene Correlation Plots\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00df21a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c813294d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "32d218d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "59518bd0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "69dee20d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "beb4c4f3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Cck-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Cck expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Cck\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b40818ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "169601e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "883cc222",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e923779f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "91030c28",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c3f8dd11",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Pitx1-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Pitx1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5142abba",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d8919a40",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cfbc7e22",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d5f57834",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a6dcb61",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6f651da5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya1-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3121a142",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5377effd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8976bd89",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "16039273",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "016732dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4be8aca2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "277dcbf9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9c5380a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "938c0022",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "124c64c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc1d3ef4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c47d02b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fbd81ec7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1642b00e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd6604fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "28ad3a85",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0bdcd455",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f86ee4d9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6099a3e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fdd20359",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "127ff0ba",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "33effc06",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a9139cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "76b87cd5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b6beba54",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6896b878",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ea052e4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e5a9345",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb03a0e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54ed928b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f093ddd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6240a32d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8ea6948e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d35cea82",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29e21b8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "47357efa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b0422b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba7226c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a2c89e04",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82aa9873",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4237c2b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f81c045c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0a97983d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "feac8018",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b5ae176e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9b141aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0905d19f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fec328b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cea3cd89",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35a5be0b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fdede935",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f6fbef7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "afba080d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0b30845",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshb-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Tshb and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshb\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9dfaf97d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-E15\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "70a47a90",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-E17\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9926656e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P0\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc5460f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P2\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e0c829c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P10\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e3cf6d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Pitx1-P23\n",
    "#| fig-cap: \"Correlation between Cck and Pitx1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Pitx1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "67a7cd13",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e4cbc43",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bd427865",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "35bd4b82",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e1365af7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "47c1d5e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya1-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b1586377",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d6acdd31",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7ea81e82",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e9e9490b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bbfca26b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95717380",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e37026d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c012f611",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8111b721",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "462f7af3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6dc58290",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "884f8180",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "498d0e96",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00c1421d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e01d7c54",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f67b5181",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3f362b77",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6e19621",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Cck and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "df507d84",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e5309e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d1102d76",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4de9ff97",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9660b703",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fc28f98d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Cck and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a90f847b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2fdcff74",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6312d8e6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fece72b7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "109c4c52",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15a4c74d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Cck and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7f9f1983",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a4b547a8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e57b56f0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f8491c73",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82a923c1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "597db76d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Cck and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9bc02e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e45f8f6c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0fbd637d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed2e2f46",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bcaa666b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e507f1d6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Cck and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7bdf8160",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "53f63cd1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4aca3fa2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2ef39cb2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "843f392a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "96ea6c10",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Cck and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2ec779f3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "34e01c42",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "63d841fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8b5a601",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7b9ed5f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49b72291",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Cck-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Cck and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Cck\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9bf900ed",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "11d58eb8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8f3c398",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "455fbe4d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "16f65734",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "211dd2cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya1-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya1 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya1\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e5f6b85",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b2ce667",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b3f8306a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "21d77808",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cda72f14",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b30325a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00e4228d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e04cf82",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4d583a3b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bece816c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "62d150e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "60425ef2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5b66a19c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d9207b99",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1868d335",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8117ada9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1fbffbd5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7121d896",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "949c8e75",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b5d8c310",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "88a0d93d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8a593b11",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9a29b4f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe328b78",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6551f506",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c51180fd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6c1132d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e1f05ee7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "94d60c56",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f2c1c91e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "74c1a3fc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a82ea135",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0829afe4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "31b4db3b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8aaab6d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d3b2c0a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "88c7c9a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce6ae018",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57122609",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9c8368ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5be2e03d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e593c30",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7d11b5f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1e97c955",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "73a8b7ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0be2c8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0c60dd8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "946efe11",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b9b441dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d9fb0935",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "321cab4a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b722a695",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4785101d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "daef5329",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Pitx1-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Pitx1 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Pitx1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "64cacebc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6597fcec",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f4eb1216",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b648d623",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "445af68c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b499aafe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya2-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Eya2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "22e62dbe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1dd249e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b544c26",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "60a5b920",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3320a890",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "585c9ddf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ceb6996d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "62d13f28",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "990300ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "de8838c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8fd45972",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aa54b436",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c7dbc0b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dee8ba67",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9e633892",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "20999572",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bfaca8a1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4374dc7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "db92a65b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "368d416b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce3942d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "299ae630",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6dbd3793",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "60656989",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a356a1fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e132dc2c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "72a7b7cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "27b03f62",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b955a968",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb70ac6d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c65d104b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2780fb75",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f91a3c6e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c5c374e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9ae51249",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a79fc63a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "138ce894",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6aca8e23",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1034c036",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "74afbb38",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "69b2196d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "543f9bfe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a79ec68",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc804316",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0dee8dd5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bddd91f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f12d92be",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7d1866f9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya1-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya1 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya1\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4fb83390",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a3bd40d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c7d4cdec",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c416567b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bbb152af",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1a2d9926",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya3-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Eya3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c0796be8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f26ba26b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3c21d40e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0b2089b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "845ddd3a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "180117b5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6b2d6dc8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4ca0ee7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bf4d7640",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bc2d4c68",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "410dd34f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "12f14805",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d9b1a9f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fdff2e70",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4dc154f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a267ac8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "57cc7e02",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cf967fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d592d482",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a34f44fe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "18a6350f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1c47a5b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "24bcc578",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4fb33951",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "86c8e3aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "20063d2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4877447a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6795505",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "18e2eb8e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2aa74af3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9b030a00",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f5d6eae7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "10027155",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f5410e04",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c455191c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "208869f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b69796d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "294b38f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "097d2b01",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e51d7d41",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b56c2b4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0e95db7d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya2-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya2 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0be02810",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a405aef",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "948cacd3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "81e5b365",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "449f3bbe",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "997ff506",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Eya4-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Eya4 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Eya4\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54bb2abd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ef84381a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fab66a32",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8f786790",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f3c78e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "296344f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ea6cf2a8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d038d9e6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "25032c85",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3fae899a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b83026a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "04bb4ae5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c6c0d194",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c78889ae",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b9ba2aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2f49fa26",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "671c3b96",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "040fea02",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f4e9475c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dd947413",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "68f4f697",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3daaa39d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5c613a24",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ca704405",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e48f83c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c287153f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8bec8a15",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50baf394",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b8e7631",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "611aaca4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1711cb60",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a72b2606",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "048379f0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4a5c91e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3084e7b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "20d95859",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya3-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya3 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "953141f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0bdcfffd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2a2893f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "881ee12c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "454ea85f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a5ffb5e7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Sox2-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Sox2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Sox2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e307892d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9f21abc7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61887424",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c0147467",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "51a6b3b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45f004ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dc7e35c3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b1f04ce7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5deb1f06",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a357701c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dee884db",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe5e4c8b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41cc1d2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5ed61c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec14832d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "409c2de4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "221d3f56",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e325ee36",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "812b4ba7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bf85a10d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e999dee1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "339b283a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a6c267af",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82c81cc8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe7fa593",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d5bab388",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f9def625",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c47ce3ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3d07bcfc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1ac79ef9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Eya4-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Eya4 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Eya4\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "089392dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "75057764",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba23cbee",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "52bfd229",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2fea7f8a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e860135a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Hlf-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Hlf expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Hlf\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6d0ec728",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b1097acf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "de71ad6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d90d5e9a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8b2d2016",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "704cea45",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ef06e89e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7103174e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "af9988f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "033c1c6e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "39df40c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0869f3e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1fd54d56",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7342b70c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5ddf1617",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dd5e6310",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c9a7bb6d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cdba4d73",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "212c7e0a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "59b72b92",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "18518ffd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "593d2250",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "440bd2ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b33b6fa",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Sox2-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Sox2 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Sox2\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "564e82c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d582d6c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "06ea7a0f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02294311",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b1010d97",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d3d93a7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Tshr-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Tshr expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Tshr\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e65f8de",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b217ac33",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6e7e08bd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d1e1891a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "91ce322d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "91ac8167",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f3a6b91",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b0b14a63",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b407c47d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f302664",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f70e42ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "64acf753",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a6527446",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5e822f7a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc75fdb3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "87e40731",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "222d9c5f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c4902660",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Hlf-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Hlf and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Hlf\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dbec26cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bce437c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-E17\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ce2c01cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P0\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71660530",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P2\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5834c690",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P10\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ffd3436f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gpr173-P23\n",
    "#| fig-cap: \"Correlation between Tshr and Gpr173 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshr\", \"Gpr173\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58bb9f74",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd3823b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "03068744",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "51c1d313",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c1e9cced",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "334f7df7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Tshr and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshr\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71900964",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5df4333b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d21e6d9f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5533d844",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61e5b69b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f3cf07b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Tshr-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Tshr and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Tshr\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a2d0dd2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-E15\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f9227685",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-E17\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c987bcfd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P0\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9ea8b47e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P2\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7cdc0e4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P10\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c849b8a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Lhx3-P23\n",
    "#| fig-cap: \"Correlation between Gpr173 and Lhx3 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Gpr173\", \"Lhx3\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5b1bb4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7e851cb3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c45980b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b4696720",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eba0f95e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8f56a99",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Gpr173-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Gpr173 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Gpr173\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "428948ac",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-E15\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E15 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E15\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E15\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "88a4f63a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-E17\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at E17 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"E17\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"E17\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a435169",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P0\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P0 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P0\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P0\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f69832c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P2\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P2 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P2\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P2\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8c988f20",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P10\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P10 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P10\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P10\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1fd7874d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: fig-romanov2020-correlation-Lhx3-Gata2-P23\n",
    "#| fig-cap: \"Correlation between Lhx3 and Gata2 expression at P23 in Romanov et al. 2020 dataset\"\n",
    "#| fig-width: 12\n",
    "#| fig-height: 8\n",
    "\n",
    "generate_correlation_plots(\n",
    "  srt.romanov.pub |> subset(Age == \"P23\"),\n",
    "  c(\"Lhx3\", \"Gata2\"),\n",
    "  \"predicted.id\",\n",
    "  cells_to_check,\n",
    "  age = \"P23\"\n",
    ")"
   ]
  }
 ],
 "metadata": {},
 "nbformat": 4,
 "nbformat_minor": 5
}





#### Dotplots





::: {#cell-fig-dotplot-dendrogram-genes-romanov2020 .cell}

```{.r .cell-code .hidden}
#| label: fig-dotplot-dendrogram-genes-romanov2020
#| fig-cap: "Dotplot of selected genes in hypothalamus across different developmental stages in the Romanov et al. (2020) dataset. Cells are colored by expression level.  Note the distinct localization patterns of each gene."
#| fig-width: 6
#| fig-height: 6
Idents(srt.kim) <- "Age"

DotPlot_scCustom(seurat_object = subset(srt.romanov.pub, cells = cells_to_check), colors_use = viridis(n = 30, alpha = .75, direction = -1, option = "E"), features = genes_to_check, flip_axes = T, x_lab_rotate = TRUE, dot.scale = 15)
```

::: {.cell-output-display}
![Dotplot of selected genes in hypothalamus across different developmental stages in the Romanov et al. (2020) dataset. Cells are colored by expression level.  Note the distinct localization patterns of each gene.](01-de_test-focus_pars_tub_files/figure-html/fig-dotplot-dendrogram-genes-romanov2020-1.png){#fig-dotplot-dendrogram-genes-romanov2020 width=576}
:::
:::





## Barplot of Sox2 and Tshr expression in hypothalamus across different developmental stages





::: {#cell-fig-sox2-tshr-bargraph .cell}

```{.r .cell-code .hidden}
#| label: fig-sox2-tshr-bargraph
#| fig-width: 7
#| #| fig-height: 6
# Create a new variable that combines Sox2_pos and Tshr_pos
df <- sbs_mtx %>%
  mutate(Age = factor(Age, levels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"), ordered = TRUE), VarComb = case_when(
    Sox2_pos & Tshr_pos ~ "Sox2+/Tshr+",
    Sox2_pos & !Tshr_pos ~ "Sox2+/Tshr-",
    !Sox2_pos & Tshr_pos ~ "Sox2-/Tshr+",
    !Sox2_pos & !Tshr_pos ~ "Sox2-/Tshr-"
  ))

# Calculate counts and proportions for each category
df_counts <- df %>%
  group_by(Age, VarComb) %>%
  summarise(n = n()) %>%
  mutate(prop = n / sum(n))
```

::: {.cell-output .cell-output-stderr .hidden}

```
`summarise()` has grouped output by 'Age'. You can override using the `.groups`
argument.
```


:::

```{.r .cell-code .hidden}
#| label: fig-sox2-tshr-bargraph
#| fig-width: 7
#| #| fig-height: 6
# Calculate the total counts for each category
df_total_counts <- df %>%
  group_by(Age) %>%
  summarise(total_n = n())

# Create a vector of Age names ordered by prop for Sox2+/Tshr+ cases for each Age
ordered_Ages <- df_counts %>%
  filter(VarComb == "Sox2+/Tshr-") %>%
  arrange(desc(prop)) %>%
  pull(Age)

# Reorder the factor levels of Age
df_counts$Age <- factor(df_counts$Age, levels = ordered_Ages)
df_total_counts$Age <- factor(df_total_counts$Age, levels = ordered_Ages)

# Reorder the factor levels of combinations
df_counts$VarComb <- factor(df_counts$VarComb, levels = rev(c("Sox2+/Tshr-", "Sox2+/Tshr+", "Sox2-/Tshr+", "Sox2-/Tshr-")))

# Create a stacked bar plot
ggplot(df_counts, aes(x = Age, y = n, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = c("Sox2+/Tshr+" = "purple", "Sox2+/Tshr-" = "red3", "Sox2-/Tshr+" = "royalblue", "Sox2-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Number of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts, aes(x = Age, y = prop, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black", position = "fill") +
  scale_fill_manual(values = c("Sox2+/Tshr-" = "red3", "Sox2+/Tshr+" = "purple", "Sox2-/Tshr+" = "royalblue", "Sox2-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Proportion of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts |> filter(!VarComb %in% c("Sox2-/Tshr-", "Sox2+/Tshr-")), aes(x = Age, y = n, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = c("Sox2+/Tshr+" = "purple", "Sox2+/Tshr-" = "red3", "Sox2-/Tshr+" = "royalblue", "Sox2-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Number of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts |> filter(!VarComb %in% c("Sox2-/Tshr-", "Sox2+/Tshr-")), aes(x = Age, y = prop, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black", position = "fill") +
  scale_fill_manual(values = c("Sox2+/Tshr-" = "red3", "Sox2+/Tshr+" = "purple", "Sox2-/Tshr+" = "royalblue", "Sox2-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Proportion of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))
```

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-tshr-bargraph-1.png){#fig-sox2-tshr-bargraph-1 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-tshr-bargraph-2.png){#fig-sox2-tshr-bargraph-2 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-tshr-bargraph-3.png){#fig-sox2-tshr-bargraph-3 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-tshr-bargraph-4.png){#fig-sox2-tshr-bargraph-4 width=672}
:::
:::





# Calculate and plot chi2 test of independence between Sox2 and Cckbr expression in hypothalamus across different developmental stages





::: {.cell}

```{.r .cell-code .hidden}
#| label: get-goi-sox2-Cckbr
sbs_mtx <- GetAssayData(object = srt.kim, layer = "counts", assay = "RNA")[c("Sox2", "Cckbr"), ] %>%
  as.data.frame() %>%
  t() %>%
  as.data.frame() %>%
  select(Sox2, Cckbr) %>%
  dplyr::bind_cols(srt.kim@meta.data) %>%
  select(Age, Sox2, Cckbr) %>%
  mutate(
    Sox2_pos = Sox2 > 0,
    Cckbr_pos = Cckbr > 0
  )

sbs_mtx %>% skimr::skim()
```

::: {.cell-output-display}

Table: Data summary

|                         |           |
|:------------------------|:----------|
|Name                     |Piped data |
|Number of rows           |128006     |
|Number of columns        |5          |
|_______________________  |           |
|Column type frequency:   |           |
|factor                   |1          |
|logical                  |2          |
|numeric                  |2          |
|________________________ |           |
|Group variables          |None       |


**Variable type: factor**

|skim_variable | n_missing| complete_rate|ordered | n_unique|top_counts                                    |
|:-------------|---------:|-------------:|:-------|--------:|:---------------------------------------------|
|Age           |         0|             1|FALSE   |       12|P45: 17025, E16: 16781, E14: 16543, P8: 13677 |


**Variable type: logical**

|skim_variable | n_missing| complete_rate| mean|count                   |
|:-------------|---------:|-------------:|----:|:-----------------------|
|Sox2_pos      |         0|             1| 0.14|FAL: 110343, TRU: 17663 |
|Cckbr_pos     |         0|             1| 0.00|FAL: 127679, TRU: 327   |


**Variable type: numeric**

|skim_variable | n_missing| complete_rate| mean|   sd| p0| p25| p50| p75| p100|hist  |
|:-------------|---------:|-------------:|----:|----:|--:|---:|---:|---:|----:|:-----|
|Sox2          |         0|             1| 0.27| 1.21|  0|   0|   0|   0|   82|▇▁▁▁▁ |
|Cckbr         |         0|             1| 0.00| 0.06|  0|   0|   0|   0|    7|▇▁▁▁▁ |


:::
:::

::: {#cell-fig-sox2-Cckbr-stats .cell}

```{.r .cell-code .hidden}
#| label: fig-sox2-Cckbr-stats
#| fig-width: 8
#| fig-height: 24
write_csv(sbs_mtx, here(tables_dir, "Sox2-Cckbr-expression-status-between-Ages-on-evaluation-datasets.csv"))


# plot
grouped_ggpiestats(
  data = sbs_mtx,
  x = Cckbr_pos,
  y = Sox2_pos,
  grouping.var = Age,
  perc.k = 1,
  package = "ggsci",
  palette = "category10_d3",
  title.text = "Sox2 specification of Cckbr-positive hypothalamic development",
  caption.text = "Asterisks denote results from proportion tests; \n***: p < 0.001, ns: non-significant",
  plotgrid.args = list(nrow = 8)
)
```

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-Cckbr-stats-1.png){#fig-sox2-Cckbr-stats width=768}
:::
:::





## Barplot of Sox2 and Cckbr expression in hypothalamus across different developmental stages





::: {#cell-fig-sox2-Cckbr-bargraph .cell}

```{.r .cell-code .hidden}
#| label: fig-sox2-Cckbr-bargraph
#| fig-width: 7
#| fig-height: 6
# Create a new variable that combines Sox2_pos and Cckbr_pos
df <- sbs_mtx %>%
  mutate(Age = factor(Age, levels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"), ordered = TRUE), VarComb = case_when(
    Sox2_pos & Cckbr_pos ~ "Sox2+/Cckbr+",
    Sox2_pos & !Cckbr_pos ~ "Sox2+/Cckbr-",
    !Sox2_pos & Cckbr_pos ~ "Sox2-/Cckbr+",
    !Sox2_pos & !Cckbr_pos ~ "Sox2-/Cckbr-"
  ))

# Calculate counts and proportions for each category
df_counts <- df %>%
  group_by(Age, VarComb) %>%
  summarise(n = n()) %>%
  mutate(prop = n / sum(n))
```

::: {.cell-output .cell-output-stderr .hidden}

```
`summarise()` has grouped output by 'Age'. You can override using the `.groups`
argument.
```


:::

```{.r .cell-code .hidden}
#| label: fig-sox2-Cckbr-bargraph
#| fig-width: 7
#| fig-height: 6
# Calculate the total counts for each category
df_total_counts <- df %>%
  group_by(Age) %>%
  summarise(total_n = n())

# Create a vector of Age names ordered by prop for Sox2+/Cckbr+ cases for each Age
ordered_Ages <- df_counts %>%
  filter(VarComb == "Sox2+/Cckbr-") %>%
  arrange(desc(prop)) %>%
  pull(Age)

# Reorder the factor levels of Age
df_counts$Age <- factor(df_counts$Age, levels = ordered_Ages)
df_total_counts$Age <- factor(df_total_counts$Age, levels = ordered_Ages)

# Reorder the factor levels of combinations
df_counts$VarComb <- factor(df_counts$VarComb, levels = rev(c("Sox2+/Cckbr-", "Sox2+/Cckbr+", "Sox2-/Cckbr+", "Sox2-/Cckbr-")))

# Create a stacked bar plot
ggplot(df_counts, aes(x = Age, y = n, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = c("Sox2+/Cckbr+" = "yellow", "Sox2+/Cckbr-" = "red3", "Sox2-/Cckbr+" = "green", "Sox2-/Cckbr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Number of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts, aes(x = Age, y = prop, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black", position = "fill") +
  scale_fill_manual(values = c("Sox2+/Cckbr-" = "red3", "Sox2+/Cckbr+" = "yellow", "Sox2-/Cckbr+" = "green", "Sox2-/Cckbr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Proportion of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts |> filter(!VarComb %in% c("Sox2-/Cckbr-", "Sox2+/Cckbr-")), aes(x = Age, y = n, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = c("Sox2+/Cckbr+" = "yellow", "Sox2+/Cckbr-" = "red3", "Sox2-/Cckbr+" = "green", "Sox2-/Cckbr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Number of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts |> filter(!VarComb %in% c("Sox2-/Cckbr-", "Sox2+/Cckbr-")), aes(x = Age, y = prop, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black", position = "fill") +
  scale_fill_manual(values = c("Sox2+/Cckbr-" = "red3", "Sox2+/Cckbr+" = "yellow", "Sox2-/Cckbr+" = "green", "Sox2-/Cckbr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Proportion of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))
```

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-Cckbr-bargraph-1.png){#fig-sox2-Cckbr-bargraph-1 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-Cckbr-bargraph-2.png){#fig-sox2-Cckbr-bargraph-2 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-Cckbr-bargraph-3.png){#fig-sox2-Cckbr-bargraph-3 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-Cckbr-bargraph-4.png){#fig-sox2-Cckbr-bargraph-4 width=672}
:::
:::





# Calculate and plot chi2 test of independence between Cckbr and Tshr expression in hypothalamus across different developmental stages





::: {.cell}

```{.r .cell-code .hidden}
#| label: get-goi-Cckbr-tshr
sbs_mtx <- GetAssayData(object = srt.kim, layer = "counts", assay = "RNA")[c("Cckbr", "Tshr"), ] %>%
  as.data.frame() %>%
  t() %>%
  as.data.frame() %>%
  select(Cckbr, Tshr) %>%
  dplyr::bind_cols(srt.kim@meta.data) %>%
  select(Age, Cckbr, Tshr) %>%
  mutate(
    Cckbr_pos = Cckbr > 0,
    Tshr_pos = Tshr > 0
  )

sbs_mtx %>% skimr::skim()
```

::: {.cell-output-display}

Table: Data summary

|                         |           |
|:------------------------|:----------|
|Name                     |Piped data |
|Number of rows           |128006     |
|Number of columns        |5          |
|_______________________  |           |
|Column type frequency:   |           |
|factor                   |1          |
|logical                  |2          |
|numeric                  |2          |
|________________________ |           |
|Group variables          |None       |


**Variable type: factor**

|skim_variable | n_missing| complete_rate|ordered | n_unique|top_counts                                    |
|:-------------|---------:|-------------:|:-------|--------:|:---------------------------------------------|
|Age           |         0|             1|FALSE   |       12|P45: 17025, E16: 16781, E14: 16543, P8: 13677 |


**Variable type: logical**

|skim_variable | n_missing| complete_rate| mean|count                 |
|:-------------|---------:|-------------:|----:|:---------------------|
|Cckbr_pos     |         0|             1|    0|FAL: 127679, TRU: 327 |
|Tshr_pos      |         0|             1|    0|FAL: 127714, TRU: 292 |


**Variable type: numeric**

|skim_variable | n_missing| complete_rate| mean|   sd| p0| p25| p50| p75| p100|hist  |
|:-------------|---------:|-------------:|----:|----:|--:|---:|---:|---:|----:|:-----|
|Cckbr         |         0|             1|    0| 0.06|  0|   0|   0|   0|    7|▇▁▁▁▁ |
|Tshr          |         0|             1|    0| 0.06|  0|   0|   0|   0|    5|▇▁▁▁▁ |


:::
:::

::: {#cell-fig-Cckbr-tshr-stats .cell}

```{.r .cell-code .hidden}
#| label: fig-Cckbr-tshr-stats
#| fig-width: 8
#| fig-height: 24
write_csv(sbs_mtx, here(tables_dir, "Cckbr-Tshr-expression-status-between-Ages-on-evaluation-datasets.csv"))


# plot
grouped_ggpiestats(
  data = sbs_mtx,
  x = Cckbr_pos,
  y = Tshr_pos,
  grouping.var = Age,
  perc.k = 1,
  package = "ggsci",
  palette = "category10_d3",
  title.text = "Cckbr specification of Tshr-positive hypothalamic development",
  caption.text = "Asterisks denote results from proportion tests; \n***: p < 0.001, ns: non-significant",
  plotgrid.args = list(nrow = 8)
)
```

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-Cckbr-tshr-stats-1.png){#fig-Cckbr-tshr-stats width=768}
:::
:::





## Barplot of Cckbr and Tshr expression in hypothalamus across different developmental stages





::: {#cell-fig-Cckbr-tshr-bargraph .cell}

```{.r .cell-code .hidden}
#| label: fig-Cckbr-tshr-bargraph
#| fig-width: 7
#| fig-height: 6
# Create a new variable that combines Cckbr_pos and Tshr_pos
df <- sbs_mtx %>%
  mutate(Age = factor(Age, levels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"), ordered = TRUE), VarComb = case_when(
    Cckbr_pos & Tshr_pos ~ "Cckbr+/Tshr+",
    Cckbr_pos & !Tshr_pos ~ "Cckbr+/Tshr-",
    !Cckbr_pos & Tshr_pos ~ "Cckbr-/Tshr+",
    !Cckbr_pos & !Tshr_pos ~ "Cckbr-/Tshr-"
  ))

# Calculate counts and proportions for each category
df_counts <- df %>%
  group_by(Age, VarComb) %>%
  summarise(n = n()) %>%
  mutate(prop = n / sum(n))
```

::: {.cell-output .cell-output-stderr .hidden}

```
`summarise()` has grouped output by 'Age'. You can override using the `.groups`
argument.
```


:::

```{.r .cell-code .hidden}
#| label: fig-Cckbr-tshr-bargraph
#| fig-width: 7
#| fig-height: 6
# Calculate the total counts for each category
df_total_counts <- df %>%
  group_by(Age) %>%
  summarise(total_n = n())

# Create a vector of Age names ordered by prop for Cckbr+/Tshr+ cases for each Age
ordered_Ages <- df_counts %>%
  filter(VarComb == "Cckbr+/Tshr-") %>%
  arrange(desc(prop)) %>%
  pull(Age)

# Reorder the factor levels of Age
df_counts$Age <- factor(df_counts$Age, levels = ordered_Ages)
df_total_counts$Age <- factor(df_total_counts$Age, levels = ordered_Ages)

# Reorder the factor levels of combinations
df_counts$VarComb <- factor(df_counts$VarComb, levels = rev(c("Cckbr+/Tshr-", "Cckbr+/Tshr+", "Cckbr-/Tshr+", "Cckbr-/Tshr-")))

# Create a stacked bar plot
ggplot(df_counts, aes(x = Age, y = n, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = c("Cckbr+/Tshr+" = "cyan", "Cckbr+/Tshr-" = "green", "Cckbr-/Tshr+" = "royalblue", "Cckbr-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Number of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts, aes(x = Age, y = prop, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black", position = "fill") +
  scale_fill_manual(values = c("Cckbr+/Tshr-" = "green", "Cckbr+/Tshr+" = "cyan", "Cckbr-/Tshr+" = "royalblue", "Cckbr-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Proportion of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts |> filter(!VarComb %in% c("Cckbr-/Tshr-", "Cckbr+/Tshr-")), aes(x = Age, y = n, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = c("Cckbr+/Tshr+" = "cyan", "Cckbr+/Tshr-" = "green", "Cckbr-/Tshr+" = "royalblue", "Cckbr-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Number of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts |> filter(!VarComb %in% c("Cckbr-/Tshr-", "Cckbr+/Tshr-")), aes(x = Age, y = prop, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black", position = "fill") +
  scale_fill_manual(values = c("Cckbr+/Tshr-" = "green", "Cckbr+/Tshr+" = "cyan", "Cckbr-/Tshr+" = "royalblue", "Cckbr-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Proportion of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))
```

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-Cckbr-tshr-bargraph-1.png){#fig-Cckbr-tshr-bargraph-1 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-Cckbr-tshr-bargraph-2.png){#fig-Cckbr-tshr-bargraph-2 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-Cckbr-tshr-bargraph-3.png){#fig-Cckbr-tshr-bargraph-3 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-Cckbr-tshr-bargraph-4.png){#fig-Cckbr-tshr-bargraph-4 width=672}
:::
:::





# Calculate and plot chi2 test of independence between Sox2 and Gpr173 expression in hypothalamus across different developmental stages





::: {.cell}

```{.r .cell-code .hidden}
#| label: get-goi-sox2-Gpr173
sbs_mtx <- GetAssayData(object = srt.kim, layer = "counts", assay = "RNA")[c("Sox2", "Gpr173"), ] %>%
  as.data.frame() %>%
  t() %>%
  as.data.frame() %>%
  select(Sox2, Gpr173) %>%
  dplyr::bind_cols(srt.kim@meta.data) %>%
  select(Age, Sox2, Gpr173) %>%
  mutate(
    Sox2_pos = Sox2 > 0,
    Gpr173_pos = Gpr173 > 0
  )

sbs_mtx %>% skimr::skim()
```

::: {.cell-output-display}

Table: Data summary

|                         |           |
|:------------------------|:----------|
|Name                     |Piped data |
|Number of rows           |128006     |
|Number of columns        |5          |
|_______________________  |           |
|Column type frequency:   |           |
|factor                   |1          |
|logical                  |2          |
|numeric                  |2          |
|________________________ |           |
|Group variables          |None       |


**Variable type: factor**

|skim_variable | n_missing| complete_rate|ordered | n_unique|top_counts                                    |
|:-------------|---------:|-------------:|:-------|--------:|:---------------------------------------------|
|Age           |         0|             1|FALSE   |       12|P45: 17025, E16: 16781, E14: 16543, P8: 13677 |


**Variable type: logical**

|skim_variable | n_missing| complete_rate| mean|count                   |
|:-------------|---------:|-------------:|----:|:-----------------------|
|Sox2_pos      |         0|             1| 0.14|FAL: 110343, TRU: 17663 |
|Gpr173_pos    |         0|             1| 0.02|FAL: 125963, TRU: 2043  |


**Variable type: numeric**

|skim_variable | n_missing| complete_rate| mean|   sd| p0| p25| p50| p75| p100|hist  |
|:-------------|---------:|-------------:|----:|----:|--:|---:|---:|---:|----:|:-----|
|Sox2          |         0|             1| 0.27| 1.21|  0|   0|   0|   0|   82|▇▁▁▁▁ |
|Gpr173        |         0|             1| 0.02| 0.13|  0|   0|   0|   0|    4|▇▁▁▁▁ |


:::
:::

::: {#cell-fig-sox2-Gpr173-stats .cell}

```{.r .cell-code .hidden}
#| label: fig-sox2-Gpr173-stats
#| fig-width: 8
#| fig-height: 24
write_csv(sbs_mtx, here(tables_dir, "Sox2-Gpr173-expression-status-between-Ages-on-evaluation-datasets.csv"))


# plot
grouped_ggpiestats(
  data = sbs_mtx,
  x = Gpr173_pos,
  y = Sox2_pos,
  grouping.var = Age,
  perc.k = 1,
  package = "ggsci",
  palette = "category10_d3",
  title.text = "Sox2 specification of Gpr173-positive hypothalamic development",
  caption.text = "Asterisks denote results from proportion tests; \n***: p < 0.001, ns: non-significant",
  plotgrid.args = list(nrow = 8)
)
```

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-Gpr173-stats-1.png){#fig-sox2-Gpr173-stats width=768}
:::
:::





## Barplot of Sox2 and Gpr173 expression in hypothalamus across different developmental stages





::: {#cell-fig-sox2-Gpr173-bargraph .cell}

```{.r .cell-code .hidden}
#| label: fig-sox2-Gpr173-bargraph
#| fig-width: 7
#| fig-height: 6
# Create a new variable that combines Sox2_pos and Gpr173_pos
df <- sbs_mtx %>%
  mutate(Age = factor(Age, levels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"), ordered = TRUE), VarComb = case_when(
    Sox2_pos & Gpr173_pos ~ "Sox2+/Gpr173+",
    Sox2_pos & !Gpr173_pos ~ "Sox2+/Gpr173-",
    !Sox2_pos & Gpr173_pos ~ "Sox2-/Gpr173+",
    !Sox2_pos & !Gpr173_pos ~ "Sox2-/Gpr173-"
  ))

# Calculate counts and proportions for each category
df_counts <- df %>%
  group_by(Age, VarComb) %>%
  summarise(n = n()) %>%
  mutate(prop = n / sum(n))
```

::: {.cell-output .cell-output-stderr .hidden}

```
`summarise()` has grouped output by 'Age'. You can override using the `.groups`
argument.
```


:::

```{.r .cell-code .hidden}
#| label: fig-sox2-Gpr173-bargraph
#| fig-width: 7
#| fig-height: 6
# Calculate the total counts for each category
df_total_counts <- df %>%
  group_by(Age) %>%
  summarise(total_n = n())

# Create a vector of Age names ordered by prop for Sox2+/Gpr173+ cases for each Age
ordered_Ages <- df_counts %>%
  filter(VarComb == "Sox2+/Gpr173-") %>%
  arrange(desc(prop)) %>%
  pull(Age)

# Reorder the factor levels of Age
df_counts$Age <- factor(df_counts$Age, levels = ordered_Ages)
df_total_counts$Age <- factor(df_total_counts$Age, levels = ordered_Ages)

# Reorder the factor levels of combinations
df_counts$VarComb <- factor(df_counts$VarComb, levels = rev(c("Sox2+/Gpr173-", "Sox2+/Gpr173+", "Sox2-/Gpr173+", "Sox2-/Gpr173-")))

# Create a stacked bar plot
ggplot(df_counts, aes(x = Age, y = n, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = c("Sox2+/Gpr173+" = "deeppink", "Sox2+/Gpr173-" = "red3", "Sox2-/Gpr173+" = "orchid", "Sox2-/Gpr173-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Number of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts, aes(x = Age, y = prop, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black", position = "fill") +
  scale_fill_manual(values = c("Sox2+/Gpr173-" = "red3", "Sox2+/Gpr173+" = "deeppink", "Sox2-/Gpr173+" = "orchid", "Sox2-/Gpr173-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Proportion of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts |> filter(!VarComb %in% c("Sox2-/Gpr173-", "Sox2+/Gpr173-")), aes(x = Age, y = n, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = c("Sox2+/Gpr173+" = "deeppink", "Sox2+/Gpr173-" = "red3", "Sox2-/Gpr173+" = "orchid", "Sox2-/Gpr173-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Number of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts |> filter(!VarComb %in% c("Sox2-/Gpr173-", "Sox2+/Gpr173-")), aes(x = Age, y = prop, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black", position = "fill") +
  scale_fill_manual(values = c("Sox2+/Gpr173-" = "red3", "Sox2+/Gpr173+" = "deeppink", "Sox2-/Gpr173+" = "orchid", "Sox2-/Gpr173-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Proportion of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))
```

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-Gpr173-bargraph-1.png){#fig-sox2-Gpr173-bargraph-1 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-Gpr173-bargraph-2.png){#fig-sox2-Gpr173-bargraph-2 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-Gpr173-bargraph-3.png){#fig-sox2-Gpr173-bargraph-3 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-sox2-Gpr173-bargraph-4.png){#fig-sox2-Gpr173-bargraph-4 width=672}
:::
:::





# Calculate and plot chi2 test of independence between Gpr173 and Tshr expression in hypothalamus across different developmental stages





::: {.cell}

```{.r .cell-code .hidden}
#| label: get-goi-Gpr173-tshr
sbs_mtx <- GetAssayData(object = srt.kim, layer = "counts", assay = "RNA")[c("Gpr173", "Tshr"), ] %>%
  as.data.frame() %>%
  t() %>%
  as.data.frame() %>%
  select(Gpr173, Tshr) %>%
  dplyr::bind_cols(srt.kim@meta.data) %>%
  select(Age, Gpr173, Tshr) %>%
  mutate(
    Gpr173_pos = Gpr173 > 0,
    Tshr_pos = Tshr > 0
  )

sbs_mtx %>% skimr::skim()
```

::: {.cell-output-display}

Table: Data summary

|                         |           |
|:------------------------|:----------|
|Name                     |Piped data |
|Number of rows           |128006     |
|Number of columns        |5          |
|_______________________  |           |
|Column type frequency:   |           |
|factor                   |1          |
|logical                  |2          |
|numeric                  |2          |
|________________________ |           |
|Group variables          |None       |


**Variable type: factor**

|skim_variable | n_missing| complete_rate|ordered | n_unique|top_counts                                    |
|:-------------|---------:|-------------:|:-------|--------:|:---------------------------------------------|
|Age           |         0|             1|FALSE   |       12|P45: 17025, E16: 16781, E14: 16543, P8: 13677 |


**Variable type: logical**

|skim_variable | n_missing| complete_rate| mean|count                  |
|:-------------|---------:|-------------:|----:|:----------------------|
|Gpr173_pos    |         0|             1| 0.02|FAL: 125963, TRU: 2043 |
|Tshr_pos      |         0|             1| 0.00|FAL: 127714, TRU: 292  |


**Variable type: numeric**

|skim_variable | n_missing| complete_rate| mean|   sd| p0| p25| p50| p75| p100|hist  |
|:-------------|---------:|-------------:|----:|----:|--:|---:|---:|---:|----:|:-----|
|Gpr173        |         0|             1| 0.02| 0.13|  0|   0|   0|   0|    4|▇▁▁▁▁ |
|Tshr          |         0|             1| 0.00| 0.06|  0|   0|   0|   0|    5|▇▁▁▁▁ |


:::
:::

::: {#cell-fig-Gpr173-tshr-stats .cell}

```{.r .cell-code .hidden}
#| label: fig-Gpr173-tshr-stats
#| fig-width: 8
#| fig-height: 24
write_csv(sbs_mtx, here(tables_dir, "Gpr173-Tshr-expression-status-between-Ages-on-evaluation-datasets.csv"))


# plot
grouped_ggpiestats(
  data = sbs_mtx,
  x = Gpr173_pos,
  y = Tshr_pos,
  grouping.var = Age,
  perc.k = 1,
  package = "ggsci",
  palette = "category10_d3",
  title.text = "Gpr173 specification of Tshr-positive hypothalamic development",
  caption.text = "Asterisks denote results from proportion tests; \n***: p < 0.001, ns: non-significant",
  plotgrid.args = list(nrow = 8)
)
```

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-Gpr173-tshr-stats-1.png){#fig-Gpr173-tshr-stats width=768}
:::
:::





## Barplot of Gpr173 and Tshr expression in hypothalamus across different developmental stages





::: {#cell-fig-Gpr173-tshr-bargraph .cell}

```{.r .cell-code .hidden}
#| label: fig-Gpr173-tshr-bargraph
#| fig-width: 7
#| fig-height: 6
# Create a new variable that combines Gpr173_pos and Tshr_pos
df <- sbs_mtx %>%
  mutate(Age = factor(Age, levels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"), ordered = TRUE), VarComb = case_when(
    Gpr173_pos & Tshr_pos ~ "Gpr173+/Tshr+",
    Gpr173_pos & !Tshr_pos ~ "Gpr173+/Tshr-",
    !Gpr173_pos & Tshr_pos ~ "Gpr173-/Tshr+",
    !Gpr173_pos & !Tshr_pos ~ "Gpr173-/Tshr-"
  ))

# Calculate counts and proportions for each category
df_counts <- df %>%
  group_by(Age, VarComb) %>%
  summarise(n = n()) %>%
  mutate(prop = n / sum(n))
```

::: {.cell-output .cell-output-stderr .hidden}

```
`summarise()` has grouped output by 'Age'. You can override using the `.groups`
argument.
```


:::

```{.r .cell-code .hidden}
#| label: fig-Gpr173-tshr-bargraph
#| fig-width: 7
#| fig-height: 6
# Calculate the total counts for each category
df_total_counts <- df %>%
  group_by(Age) %>%
  summarise(total_n = n())

# Create a vector of Age names ordered by prop for Gpr173+/Tshr+ cases for each Age
ordered_Ages <- df_counts %>%
  filter(VarComb == "Gpr173+/Tshr-") %>%
  arrange(desc(prop)) %>%
  pull(Age)

# Reorder the factor levels of Age
df_counts$Age <- factor(df_counts$Age, levels = ordered_Ages)
df_total_counts$Age <- factor(df_total_counts$Age, levels = ordered_Ages)

# Reorder the factor levels of combinations
df_counts$VarComb <- factor(df_counts$VarComb, levels = rev(c("Gpr173+/Tshr-", "Gpr173+/Tshr+", "Gpr173-/Tshr+", "Gpr173-/Tshr-")))

# Create a stacked bar plot
ggplot(df_counts, aes(x = Age, y = n, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = c("Gpr173+/Tshr+" = "magenta4", "Gpr173+/Tshr-" = "orchid", "Gpr173-/Tshr+" = "royalblue", "Gpr173-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Number of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts, aes(x = Age, y = prop, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black", position = "fill") +
  scale_fill_manual(values = c("Gpr173+/Tshr-" = "orchid", "Gpr173+/Tshr+" = "magenta4", "Gpr173-/Tshr+" = "royalblue", "Gpr173-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Proportion of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts |> filter(!VarComb %in% c("Gpr173-/Tshr-", "Gpr173+/Tshr-")), aes(x = Age, y = n, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = c("Gpr173+/Tshr+" = "magenta4", "Gpr173+/Tshr-" = "orchid", "Gpr173-/Tshr+" = "royalblue", "Gpr173-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Number of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))

ggplot(df_counts |> filter(!VarComb %in% c("Gpr173-/Tshr-", "Gpr173+/Tshr-")), aes(x = Age, y = prop, fill = VarComb)) +
  geom_bar(stat = "identity", color = "black", position = "fill") +
  scale_fill_manual(values = c("Gpr173+/Tshr-" = "orchid", "Gpr173+/Tshr+" = "magenta4", "Gpr173-/Tshr+" = "royalblue", "Gpr173-/Tshr-" = "grey50")) +
  labs(x = "Hypothalamic subAge", y = "Proportion of cells", fill = "Expression") +
  scale_x_discrete(labels = c("E10", "E11", "E12", "E13", "E14", "E15", "E16", "E18", "P4", "P8", "P14", "P45"))
```

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-Gpr173-tshr-bargraph-1.png){#fig-Gpr173-tshr-bargraph-1 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-Gpr173-tshr-bargraph-2.png){#fig-Gpr173-tshr-bargraph-2 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-Gpr173-tshr-bargraph-3.png){#fig-Gpr173-tshr-bargraph-3 width=672}
:::

::: {.cell-output-display}
![](01-de_test-focus_pars_tub_files/figure-html/fig-Gpr173-tshr-bargraph-4.png){#fig-Gpr173-tshr-bargraph-4 width=672}
:::
:::

::: {.cell}

```{.r .cell-code .hidden}
sessioninfo::session_info()
```

::: {.cell-output .cell-output-stdout}

```
─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.4.2 (2024-10-31)
 os       Ubuntu 22.04.5 LTS
 system   x86_64, linux-gnu
 ui       X11
 language en_US:en
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       Etc/UTC
 date     2025-01-14
 pandoc   3.1.11.1 @ /home/etretiakov/micromamba/bin/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package          * version     date (UTC) lib source
 abind              1.4-8       2024-09-12 [2] RSPM
 base64enc          0.1-3       2015-07-28 [2] RSPM (R 4.4.0)
 BayesFactor        0.9.12-4.7  2024-01-24 [2] RSPM
 bayestestR         0.15.0      2024-10-17 [2] RSPM (R 4.4.0)
 beeswarm           0.4.0       2021-06-01 [2] RSPM (R 4.4.0)
 BiocManager        1.30.25     2024-08-28 [2] RSPM (R 4.4.0)
 bit                4.5.0       2024-09-20 [2] RSPM
 bit64              4.5.2       2024-09-22 [2] RSPM
 circlize           0.4.16      2024-12-04 [2] Github (jokergoo/circlize@9b21578)
 cli                3.6.3       2024-06-21 [2] RSPM (R 4.4.0)
 cluster            2.1.6       2023-12-01 [2] CRAN (R 4.4.2)
 coda               0.19-4.1    2024-01-31 [2] RSPM
 codetools          0.2-20      2024-03-31 [2] CRAN (R 4.4.2)
 colorspace         2.1-1       2024-07-26 [2] RSPM (R 4.4.0)
 correlation        0.8.6       2024-10-26 [2] RSPM (R 4.4.0)
 cowplot          * 1.1.3       2024-01-22 [2] RSPM
 crayon             1.5.3       2024-06-20 [2] RSPM (R 4.4.0)
 data.table         1.16.2      2024-10-10 [2] RSPM
 datawizard         0.13.0.17   2024-12-04 [2] Github (easystats/datawizard@25f8ec4)
 deldir             2.0-4       2024-02-28 [2] RSPM (R 4.4.0)
 digest             0.6.37      2024-08-19 [2] RSPM (R 4.4.0)
 dotCall64          1.2         2024-10-04 [2] RSPM
 dplyr            * 1.1.4       2023-11-17 [2] RSPM (R 4.4.0)
 effectsize         0.8.9       2024-07-03 [2] RSPM (R 4.4.0)
 emmeans            1.10.5      2024-10-14 [2] RSPM
 estimability       1.5.1       2024-05-12 [2] RSPM (R 4.4.0)
 evaluate           1.0.1       2024-10-10 [2] RSPM (R 4.4.0)
 fansi              1.0.6       2023-12-08 [2] RSPM (R 4.4.0)
 farver             2.1.2       2024-05-13 [2] RSPM (R 4.4.0)
 fastDummies        1.7.4       2024-08-16 [2] RSPM
 fastmap            1.2.0       2024-05-15 [2] RSPM (R 4.4.0)
 fitdistrplus       1.2-1       2024-07-12 [2] RSPM (R 4.4.0)
 forcats          * 1.0.0       2023-01-29 [2] RSPM
 future           * 1.34.0      2024-07-29 [2] RSPM
 future.apply       1.11.3      2024-10-27 [2] RSPM
 generics           0.1.3       2022-07-05 [2] RSPM (R 4.4.0)
 ggbeeswarm         0.7.2       2024-12-04 [2] Github (eclarke/ggbeeswarm@14ef76c)
 ggplot2          * 3.5.1       2024-04-23 [2] RSPM (R 4.4.0)
 ggprism            1.0.5       2024-12-04 [2] Github (csdaw/ggprism@b6e6c0e)
 ggrastr            1.0.2       2024-12-04 [2] Github (VPetukhov/ggrastr@50ca3e0)
 ggrepel            0.9.6.9999  2024-12-04 [2] Github (slowkow/ggrepel@e72a66d)
 ggridges           0.5.6       2024-01-23 [2] RSPM
 ggsci              3.2.0       2024-12-04 [2] Github (nanxstats/ggsci@b5bf1fd)
 ggstatsplot      * 0.12.5.9000 2024-12-04 [2] Github (IndrajeetPatil/ggstatsplot@d312b9f)
 GlobalOptions      0.1.2       2020-06-10 [2] RSPM (R 4.4.0)
 globals            0.16.3      2024-03-08 [2] RSPM
 glue               1.8.0       2024-09-30 [2] RSPM (R 4.4.0)
 goftest            1.2-3       2021-10-07 [2] RSPM
 gridExtra          2.3         2017-09-09 [2] RSPM
 gtable             0.3.6       2024-10-25 [2] RSPM (R 4.4.0)
 here             * 1.0.1       2020-12-13 [2] RSPM
 hexbin           * 1.28.5      2024-11-13 [2] RSPM (R 4.4.0)
 hms                1.1.3       2023-03-21 [2] RSPM
 htmltools          0.5.8.1     2024-04-04 [2] RSPM (R 4.4.0)
 htmlwidgets        1.6.4       2023-12-06 [2] RSPM (R 4.4.0)
 httpuv             1.6.15      2024-03-26 [2] RSPM (R 4.4.0)
 httr               1.4.7       2023-08-15 [2] RSPM (R 4.4.0)
 ica                1.0-3       2022-07-08 [2] RSPM
 igraph             2.1.1       2024-10-19 [2] RSPM (R 4.4.0)
 insight            1.0.0.2     2024-12-04 [2] Github (easystats/insight@8e78b12)
 irlba              2.3.5.1     2022-10-03 [2] RSPM
 janitor            2.2.0.9000  2024-12-04 [2] Github (sfirke/janitor@6ee7919)
 jsonlite           1.8.9       2024-09-20 [2] RSPM (R 4.4.0)
 KernSmooth         2.23-24     2024-05-17 [2] CRAN (R 4.4.2)
 knitr              1.49        2024-11-08 [2] RSPM
 labeling           0.4.3       2023-08-29 [2] RSPM (R 4.4.0)
 later              1.4.1       2024-11-27 [2] RSPM (R 4.4.0)
 lattice            0.22-6      2024-03-20 [2] CRAN (R 4.4.2)
 lazyeval           0.2.2       2019-03-15 [2] RSPM (R 4.4.0)
 leiden             0.4.3.1     2023-11-17 [2] RSPM
 lifecycle          1.0.4       2023-11-07 [2] RSPM (R 4.4.0)
 listenv            0.9.1       2024-01-29 [2] RSPM
 lmtest             0.9-40      2022-03-21 [2] RSPM (R 4.4.0)
 lubridate        * 1.9.3       2023-09-27 [2] RSPM
 magrittr         * 2.0.3       2022-03-30 [2] RSPM (R 4.4.0)
 MASS               7.3-61      2024-06-13 [2] CRAN (R 4.4.2)
 Matrix             1.7-1       2024-10-18 [2] CRAN (R 4.4.2)
 MatrixModels       0.5-3       2023-11-06 [2] RSPM
 matrixStats        1.4.1       2024-09-08 [2] RSPM (R 4.4.0)
 mime               0.12        2021-09-28 [2] RSPM (R 4.4.0)
 miniUI             0.1.1.1     2018-05-18 [2] RSPM
 multcomp           1.4-26      2024-07-18 [2] RSPM
 munsell            0.5.1       2024-04-01 [2] RSPM (R 4.4.0)
 mvtnorm            1.3-2       2024-11-04 [2] RSPM
 nlme               3.1-166     2024-08-14 [2] CRAN (R 4.4.2)
 paletteer          1.6.0       2024-01-21 [2] RSPM
 parallelly         1.39.0      2024-11-07 [2] RSPM
 parameters         0.24.0.3    2024-12-04 [2] Github (easystats/parameters@eff54e5)
 patchwork        * 1.3.0.9000  2024-12-04 [2] Github (thomasp85/patchwork@2695a9f)
 pbapply            1.7-2       2023-06-27 [2] RSPM
 pillar             1.9.0       2023-03-22 [2] RSPM (R 4.4.0)
 pkgconfig          2.0.3       2019-09-22 [2] RSPM (R 4.4.0)
 plotly             4.10.4      2024-01-13 [2] RSPM
 plyr               1.8.9       2023-10-02 [2] RSPM
 png                0.1-8       2022-11-29 [2] RSPM
 polyclip           1.10-7      2024-07-23 [2] RSPM (R 4.4.0)
 prismatic          1.1.2       2024-04-10 [2] RSPM
 progressr          0.15.1      2024-11-22 [2] RSPM
 promises           1.3.2       2024-11-28 [2] RSPM (R 4.4.0)
 purrr            * 1.0.2       2023-08-10 [2] RSPM (R 4.4.0)
 R.methodsS3        1.8.2       2022-06-13 [2] RSPM (R 4.4.0)
 R.oo               1.27.0      2024-11-01 [2] RSPM (R 4.4.0)
 R.utils            2.12.3      2023-11-18 [2] RSPM (R 4.4.0)
 R6                 2.5.1       2021-08-19 [2] RSPM (R 4.4.0)
 RANN               2.6.2       2024-08-25 [2] RSPM (R 4.4.0)
 RColorBrewer     * 1.1-3       2022-04-03 [2] RSPM
 Rcpp               1.0.13-1    2024-11-02 [2] RSPM (R 4.4.0)
 RcppAnnoy          0.0.22      2024-01-23 [2] RSPM
 RcppHNSW           0.6.0       2024-02-04 [2] RSPM
 readr            * 2.1.5       2024-01-10 [2] RSPM
 rematch2           2.1.2       2020-05-01 [2] RSPM
 remotes            2.5.0       2024-03-17 [2] RSPM
 repr               1.1.7       2024-03-22 [2] RSPM
 reshape2           1.4.4       2020-04-09 [2] RSPM
 reticulate         1.40.0.9000 2024-12-04 [2] Github (rstudio/reticulate@61f0fa4)
 rhdf5              2.50.0      2024-10-29 [2] RSPM (R 4.4.2)
 rhdf5filters       1.18.0      2024-10-29 [2] RSPM (R 4.4.2)
 Rhdf5lib           1.28.0      2024-10-29 [2] RSPM (R 4.4.2)
 rlang              1.1.4       2024-06-04 [2] RSPM (R 4.4.0)
 rmarkdown          2.29        2024-11-04 [2] RSPM
 ROCR               1.0-11      2020-05-02 [2] RSPM (R 4.4.0)
 rprojroot          2.0.4       2023-11-05 [2] RSPM (R 4.4.0)
 RSpectra           0.16-2      2024-07-18 [2] RSPM
 rstudioapi         0.17.1      2024-10-22 [2] RSPM
 rsvd               1.0.5       2021-04-16 [2] RSPM (R 4.4.0)
 Rtsne              0.17        2023-12-07 [2] RSPM (R 4.4.0)
 sandwich           3.1-1       2024-09-15 [2] RSPM
 scales             1.3.0       2023-11-28 [2] RSPM (R 4.4.0)
 scattermore        1.2         2023-06-12 [2] RSPM
 scCustomize      * 3.0.1       2025-01-14 [2] Github (samuel-marsh/scCustomize@3299b95)
 schard             0.0.1       2024-12-04 [2] Github (cellgeni/schard@c22b46d)
 sctransform        0.4.1       2023-10-19 [2] RSPM
 sessioninfo        1.2.2       2021-12-06 [2] RSPM
 Seurat           * 5.1.0       2024-12-04 [2] Github (satijalab/seurat@1549dcb)
 SeuratObject     * 5.0.99.9001 2024-12-04 [2] Github (satijalab/seurat-object@42e53ba)
 SeuratWrappers   * 0.4.0       2024-12-04 [2] Github (satijalab/seurat-wrappers@a1eb0d8)
 shape              1.4.6.1     2024-02-23 [2] RSPM
 shiny              1.9.1       2024-08-01 [2] RSPM (R 4.4.0)
 skimr            * 2.1.5       2024-12-04 [2] Github (ropensci/skimr@d5126aa)
 snakecase          0.11.1      2023-08-27 [2] RSPM (R 4.4.0)
 sp               * 2.1-4       2024-04-30 [2] RSPM
 spam               2.11-0      2024-10-03 [2] RSPM
 spatstat.data      3.1-4       2024-11-15 [2] RSPM (R 4.4.0)
 spatstat.explore   3.3-3       2024-10-22 [2] RSPM
 spatstat.geom      3.3-4       2024-11-18 [2] RSPM (R 4.4.0)
 spatstat.random    3.3-2       2024-09-18 [2] RSPM (R 4.4.0)
 spatstat.sparse    3.1-0       2024-06-21 [2] RSPM
 spatstat.univar    3.1-1       2024-11-05 [2] RSPM (R 4.4.0)
 spatstat.utils     3.1-1       2024-11-03 [2] RSPM (R 4.4.0)
 statsExpressions   1.6.1       2024-10-31 [2] RSPM
 stringi            1.8.4       2024-05-06 [2] RSPM (R 4.4.0)
 stringr          * 1.5.1       2023-11-14 [2] RSPM (R 4.4.0)
 survival           3.7-0       2024-06-05 [2] CRAN (R 4.4.2)
 tensor             1.5         2012-05-05 [2] RSPM
 TH.data            1.1-2       2023-04-17 [2] RSPM (R 4.4.0)
 tibble           * 3.2.1       2023-03-20 [2] RSPM (R 4.4.0)
 tidyr            * 1.3.1       2024-01-24 [2] RSPM (R 4.4.0)
 tidyselect         1.2.1       2024-03-11 [2] RSPM (R 4.4.0)
 tidyverse        * 2.0.0.9000  2024-12-04 [2] Github (tidyverse/tidyverse@c06a3c9)
 timechange         0.3.0       2024-01-18 [2] RSPM
 tzdb               0.4.0       2023-05-12 [2] RSPM
 utf8               1.2.4       2023-10-22 [2] RSPM (R 4.4.0)
 uwot               0.2.2       2024-04-21 [2] RSPM (R 4.4.0)
 vctrs              0.6.5       2023-12-01 [2] RSPM (R 4.4.0)
 vipor              0.4.7       2023-12-18 [2] RSPM (R 4.4.0)
 viridis          * 0.6.5       2024-01-29 [2] RSPM
 viridisLite      * 0.4.2       2023-05-02 [2] RSPM (R 4.4.0)
 vroom              1.6.5       2023-12-05 [2] RSPM
 withr              3.0.2       2024-10-28 [2] RSPM (R 4.4.0)
 xfun               0.49        2024-10-31 [2] RSPM (R 4.4.0)
 xtable             1.8-4       2019-04-21 [2] RSPM (R 4.4.0)
 yaml               2.3.10      2024-07-26 [2] RSPM
 zeallot            0.1.0       2018-01-28 [2] RSPM
 zoo                1.8-12      2023-04-13 [2] RSPM (R 4.4.0)

 [1] /home/etretiakov/R/x86_64-pc-linux-gnu-library/4.4
 [2] /opt/R/4.4.2/lib/R/library

─ Python configuration ───────────────────────────────────────────────────────
 python:         /opt/conda/bin/python
 libpython:      /opt/conda/lib/libpython3.12.so
 pythonhome:     /opt/conda:/opt/conda
 version:        3.12.8 | packaged by conda-forge | (main, Dec  5 2024, 14:24:40) [GCC 13.3.0]
 numpy:          /opt/conda/lib/python3.12/site-packages/numpy
 numpy_version:  1.26.4
 
 NOTE: Python version was forced by RETICULATE_PYTHON

──────────────────────────────────────────────────────────────────────────────
```


:::
:::
